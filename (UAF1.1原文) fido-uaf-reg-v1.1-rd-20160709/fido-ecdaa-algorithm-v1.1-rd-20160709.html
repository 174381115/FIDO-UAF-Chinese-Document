<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document w3p:CR" about="" property="dcterms:language" content="en" prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">
<head>
  <title>FIDO ECDAA Algorithm</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <!--
  === NOTA BENE ===
  For the three scripts below, if your spec resides on dev.w3 you can check them
  out in the same tree and use relative links so that they'll work offline,
  -->
  
  
  
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #003a7c;
}

.simple th {
    background: #003a7c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;   
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    //background: #fcfaee;    
    background: rgba(252,250,238,0.3);    
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #2b2; }
div.issue-title span, div.note-title span {
    text-transform: uppercase;
}
div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child { margin-top: 0 }
.issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}


</style><link rel="stylesheet" href="resources/FIDO-RD.css"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/2.6-latest/jax/output/HTML-CSS/jax.js?rev=2.6.1"></script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/2.6-latest/jax/output/HTML-CSS/fonts/STIX/fontdata.js?rev=2.6.1"></script></head>
<body class="h-entry" style="" role="document" id="respecDocument"><div id="MathJax_Message" style="">Loading [MathJax]/jax/output/HTML-CSS/fonts/STIX/fontdata.js</div><div class="head" role="contentinfo" id="respecHeader">
  <p>
    
      <a href="https://www.fidoalliance.org/"><img width="250" id="toplogo" src="resources/logo.png" alt="FIDO Alliance"></a>
    
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">FIDO ECDAA Algorithm</h1>
  
  <h2 property="dcterms:issued" datatype="xsd:dateTime" content="2016-07-09T07:00:00.000Z" id="fido-alliance-review-draft-09-july-2016"><abbr title="FIDO Alliance">FIDO Alliance</abbr> Review Draft <time class="dt-published" datetime="2016-07-09">09 July 2016</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="https://fidoalliance.org/specs/fido-uaf-v1.1-rd-20160709/fido-ecdaa-algorithm-v1.1-rd-20160709.html">https://fidoalliance.org/specs/fido-uaf-v1.1-rd-20160709/fido-ecdaa-algorithm-v1.1-rd-20160709.html</a></dd>
      <!--<dt>Latest published version:</dt>
      <dd><a href='https://fidoalliance.org/specs/fido-ecdaa-algorithm/'>https://fidoalliance.org/specs/fido-ecdaa-algorithm/</a></dd>
    
    -->
    
    
    
    
    
    
    <dt>Editor:</dt>
    <dd class="p-author h-card vcard" rel="bibo:editor" inlist=""><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Rolf Lindemann" href="mailto:rolf@noknok.com">Rolf Lindemann</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.noknok.com/">Nok Nok Labs, Inc.</a></span>
</dd>

    
      <dt>Contributors:</dt>
      <dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Alec Edgington" href="mailto:alec.edgington@trustonic.com">Alec Edgington</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.trustonic.com/">Trustonic</a></span>
</dd>
<dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Rainer Urian" href="mailto:rainer.urian@infineon.com">Rainer Urian</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.infineon.com/">Infineon</a></span>
</dd>

    
    
  </dl>
  
  
  
  
    
      <p class="copyright">
        Copyright ©
        2013-2016
        
        <a href="https://www.fidoalliance.org/"><abbr title="FIDO Alliance">FIDO Alliance</abbr></a>
        All Rights Reserved.
      </p>
    
  
  <hr>
</div>

<!-- only put content here if you want a custom status of document not
  the specification-maturity-appropriate boilerplate -->


<section id="abstract" class="introductory" property="dcterms:abstract" datatype="" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_abstract">Abstract</h2>
  <p>The FIDO Basic Attestation scheme uses attestation "group" keys shared across a 
    set of authenticators with identical characteristics in
    order to preserve privacy by avoiding the introduction of global correlation handles. 
    If such an attestation key is extracted from one single authenticator, it is possible 
    to create a "fake" authenticator using the 
    same key and hence indistinguishable from the original authenticators by the relying party.  
    Removing trust for registering new authenticators
    with the related key would affect the entire set of authenticators sharing the same "group" key.  
    Depending on the number of authenticators,
    this risk might be unacceptable high.
  </p>
  <p>This is especially relevant when the attestation key is primarily protected against 
    malware attacks as opposed to targeted physical attacks.
  </p>
  <p>An alternative approach to "group" keys is the use of individual 
    keys combined with a Privacy-CA [<cite><a class="bibref" href="#bib-TPMv1-2-Part1">TPMv1-2-Part1</a></cite>].  Translated to FIDO, 
    this approach would require one Privacy-CA interaction for each Uauth key.  
    This means relatively high load and high 
    availability requirements for the Privacy-CA.  Additionally the Privacy-CA aggregates sensitive 
    information (i.e. knowing the  
    relying parties the user interacts with).  This might make the Privacy-CA an interesting attack target.  
  </p>
  <p>Another alternative is the Direct Anonymous Attestation [<cite><a class="bibref" href="#bib-BriCamChe2004-DAA">BriCamChe2004-DAA</a></cite>]. 
    Direct Anonymous Attestation is a cryptographic 
    scheme combining privacy with security. It uses the authenticator specific secret 
    once to communicate with a single DAA Issuer 
    and uses the resulting DAA credential in the DAA-Sign protocol with each relying party.
    The DAA scheme has been adopted by the Trusted Computing Group for TPM v1.2 [<cite><a class="bibref" href="#bib-TPMv1-2-Part1">TPMv1-2-Part1</a></cite>].  
  </p>
  <p>In this document, we specify the use of an improved DAA scheme based on elliptic curves 
    and bilinear pairings largely compatible with [<cite><a class="bibref" href="#bib-CheLi2013-ECDAA">CheLi2013-ECDAA</a></cite>] called ECDAA.  
    This scheme provides significantly improved performance compared with the 
    original DAA and basic building blocks for its implementation are part of the TPMv2 specification [<cite><a class="bibref" href="#bib-TPMv2-Part1">TPMv2-Part1</a></cite>].
  </p>
  <p>Our improvements over [<cite><a class="bibref" href="#bib-CheLi2013-ECDAA">CheLi2013-ECDAA</a></cite>] mainly consist of security fixes 
    (see [<cite><a class="bibref" href="#bib-ANZ-2013">ANZ-2013</a></cite>] and [<cite><a class="bibref" href="#bib-XYZF-2014">XYZF-2014</a></cite>]) when splitting the sign operation into two parts.
  </p>
</section><section id="sotd" class="introductory" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_sotd">Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <abbr title="FIDO Alliance">FIDO Alliance</abbr> publications and the
          latest revision of this technical report can be found in the <a href="https://www.fidoalliance.org/specifications/"><abbr title="FIDO Alliance">FIDO Alliance</abbr> specifications index</a> at
          https://www.fidoalliance.org/specifications/.</em>
        </p>
        
        <p>
          This document was published by the <a href="https://fidoalliance.org/"><abbr title="FIDO Alliance">FIDO Alliance</abbr></a> as a Review Draft.
          
            This document is intended to become a <abbr title="FIDO Alliance">FIDO Alliance</abbr> Proposed Standard.
          
          
            If you wish to make comments regarding this document, please 
            <a href="https://fidoalliance.org/contact">Contact Us</a>.
          
          
          
          
            All comments are welcome.
          
        </p>
        
	
	
	  <div class="ribbon-wrapper"><div class="ribbon">REVIEW DRAFT</div></div>
	  <p>
	    <strong>This is a Review Draft Specification and
            is not intended to be a basis for any implementations as the Specification may change.</strong> Permission is
            hereby granted to use the Specification solely for the purpose of reviewing the Specification. No rights
            are granted to prepare derivative works of this Specification. Entities seeking permission to reproduce
            portions of this Specification for other uses must contact the <abbr title="FIDO Alliance">FIDO Alliance</abbr> to determine whether an 
            appropriate license for such use is available.
	  </p>
	
	
        
          <p>
	    Implementation of certain elements of this Specification may require licenses under third party intellectual 
	    property rights, including without limitation, patent rights. The <abbr title="FIDO Alliance">FIDO Alliance</abbr>, Inc. and its Members
            and any other contributors to the Specification are not, and shall not be held, responsible in any manner
            for identifying or failing to identify any or all such third party intellectual property rights.
	  </p>
	  <p>
	    THIS FIDO ALLIANCE SPECIFICATION IS PROVIDED “AS IS” AND WITHOUT ANY 
            WARRANTY OF ANY KIND, INCLUDING, WITHOUT LIMITATION, ANY EXPRESS OR IMPLIED
	    WARRANTY OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A
	    PARTICULAR PURPOSE.
          </p>
        
        
        
        
      
    
  
</section><section id="toc"><h2 class="introductory" aria-level="1" role="heading" id="h2_toc">Table of Contents</h2><ul class="toc" role="directory" id="respecContents"><li class="tocline"><a href="#notation" class="tocxref"><span class="secno">1. </span>Notation</a><ul class="toc"><li class="tocline"><a href="#conformance" class="tocxref"><span class="secno">1.1 </span>Conformance</a></li></ul></li><li class="tocline"><a href="#overview" class="tocxref"><span class="secno">2. </span>Overview</a><ul class="toc"><li class="tocline"><a href="#scope" class="tocxref"><span class="secno">2.1 </span>Scope</a></li><li class="tocline"><a href="#architecture-overview" class="tocxref"><span class="secno">2.2 </span>Architecture Overview</a></li></ul></li><li class="tocline"><a href="#fido-ecdaa-attestation" class="tocxref"><span class="secno">3. </span>FIDO ECDAA Attestation</a><ul class="toc"><li class="tocline"><a href="#object-encodings" class="tocxref"><span class="secno">3.1 </span>Object Encodings</a><ul class="toc"><li class="tocline"><a href="#encoding-bignumber-values-as-byte-strings-bignumbertob" class="tocxref"><span class="secno">3.1.1 </span>Encoding <code>BigNumber</code> values as byte strings (BigNumberToB)</a></li><li class="tocline"><a href="#encoding-ecpoint-values-as-byte-strings-ecpointtob" class="tocxref"><span class="secno">3.1.2 </span>Encoding <code>ECPoint</code> values as byte strings (ECPointToB)</a></li><li class="tocline"><a href="#encoding-ecpoint2-values-as-byte-strings-ecpoint2tob" class="tocxref"><span class="secno">3.1.3 </span>Encoding <code>ECPoint2</code> values as byte strings (ECPoint2ToB)</a></li></ul></li><li class="tocline"><a href="#global-ecdaa-system-parameters" class="tocxref"><span class="secno">3.2 </span>Global ECDAA System Parameters</a></li><li class="tocline"><a href="#issuer-specific-ecdaa-parameters" class="tocxref"><span class="secno">3.3 </span>Issuer Specific ECDAA Parameters</a></li><li class="tocline"><a href="#ecdaa-join" class="tocxref"><span class="secno">3.4 </span>ECDAA-Join</a><ul class="toc"><li class="tocline"><a href="#ecdaa-join-algorithm" class="tocxref"><span class="secno">3.4.1 </span>ECDAA-Join Algorithm</a></li><li class="tocline"><a href="#ecdaa-join-split-between-authenticator-and-asm" class="tocxref"><span class="secno">3.4.2 </span>ECDAA-Join Split between Authenticator and ASM</a></li><li class="tocline"><a href="#ecdaa-join-split-between-tpm-and-asm" class="tocxref"><span class="secno">3.4.3 </span>ECDAA-Join Split between TPM and ASM</a></li></ul></li><li class="tocline"><a href="#ecdaa-sign" class="tocxref"><span class="secno">3.5 </span>ECDAA-Sign</a><ul class="toc"><li class="tocline"><a href="#ecdaa-sign-algorithm" class="tocxref"><span class="secno">3.5.1 </span>ECDAA-Sign Algorithm</a></li><li class="tocline"><a href="#ecdaa-sign-split-between-authenticator-and-asm" class="tocxref"><span class="secno">3.5.2 </span>ECDAA-Sign Split between Authenticator and ASM</a></li><li class="tocline"><a href="#ecdaa-sign-split-between-tpm-and-asm" class="tocxref"><span class="secno">3.5.3 </span>ECDAA-Sign Split between TPM and ASM</a></li></ul></li><li class="tocline"><a href="#ecdaa-verify-operation" class="tocxref"><span class="secno">3.6 </span>ECDAA-Verify Operation</a></li></ul></li><li class="tocline"><a href="#fido-ecdaa-object-formats-and-algorithm-details" class="tocxref"><span class="secno">4. </span>FIDO ECDAA Object Formats and Algorithm Details</a><ul class="toc"><li class="tocline"><a href="#supported-curves-for-ecdaa" class="tocxref"><span class="secno">4.1 </span>Supported Curves for ECDAA</a></li><li class="tocline"><a href="#ecdaa-algorithm-names" class="tocxref"><span class="secno">4.2 </span>ECDAA Algorithm Names</a></li><li class="tocline"><a href="#ecdaasignature-object" class="tocxref"><span class="secno">4.3 </span>ecdaaSignature object</a></li></ul></li><li class="tocline"><a href="#considerations" class="tocxref"><span class="secno">5. </span>Considerations</a><ul class="toc"><li class="tocline"><a href="#algorithms-and-key-sizes" class="tocxref"><span class="secno">5.1 </span>Algorithms and Key Sizes</a></li><li class="tocline"><a href="#indicating-the-authenticator-model" class="tocxref"><span class="secno">5.2 </span>Indicating the Authenticator Model</a></li><li class="tocline"><a href="#revocation" class="tocxref"><span class="secno">5.3 </span>Revocation</a></li><li class="tocline"><a href="#pairing-algorithm" class="tocxref"><span class="secno">5.4 </span>Pairing Algorithm</a></li><li class="tocline"><a href="#performance" class="tocxref"><span class="secno">5.5 </span>Performance</a></li><li class="tocline"><a href="#binary-concatentation" class="tocxref"><span class="secno">5.6 </span>Binary Concatentation</a></li><li class="tocline"><a href="#iana-considerations" class="tocxref"><span class="secno">5.7 </span>IANA Considerations</a></li></ul></li><li class="tocline"><a href="#acknowledgements" class="tocxref"><span class="secno">6. </span>Acknowledgements</a></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">A. </span>References</a><ul class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">A.1 </span>Normative references</a></li><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">A.2 </span>Informative references</a></li></ul></li></ul></section>

<section id="notation">
  <!--OddPage--><h2 aria-level="1" role="heading" id="h2_notation"><span class="secno">1. </span>Notation</h2>
  
  <p>Type names, attribute names and element names are written as <code>code</code>.
    
  </p><p>String literals are enclosed in “”, e.g. “ED256”.
    
  </p><p>In formulas we use “|” to denote byte wise concatenation
    operations.

  </p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">X</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-6" style="vertical-align: 0.5em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-1">X = P^x</script> denotes scalar multiplication (with scalar x) of a (elliptic) curve point P.</p>
  <p>RAND(x) denotes generation of a random number between 0 and x-1.</p>
  <p>RAND(G) denotes generation of a random number belonging to Group G.</p>

  <p>Specific terminology used in this document is defined in
    [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>].</p>

  <p>The type <code>BigNumber</code> denotes an arbitrary length integer value.</p>

  <p>The type <code>ECPoint</code> denotes an elliptic curve point with its affine coordinates x and y.</p>

  <p>The type <code>ECPoint2</code> denotes a point on the sextic twist of a BN elliptic curve over <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">F</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-12" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-2">F(q^2)</script>.
    The ECPoint2 has two affine coordinates each having two components of type BigNumber</p>

  <section id="conformance" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h3 aria-level="2" role="heading" id="h3_conformance"><span class="secno">1.1 </span>Conformance</h3>
<p>
  As well as sections marked as non-normative, all authoring guidelines, diagrams, examples,
  and notes in this specification are non-normative. Everything else in this specification is
  normative.
</p>
<p>
  The key words <em class="rfc2119" title="MUST">MUST</em>, <em class="rfc2119" title="MUST NOT">MUST NOT</em>, <em class="rfc2119" title="REQUIRED">REQUIRED</em>, <em class="rfc2119" title="SHOULD">SHOULD</em>, <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em>, <em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em>, <em class="rfc2119" title="MAY">MAY</em>,
  and <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> in this specification are to be interpreted as described in [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>].
</p>
  <!-- inserts normative/non-normative & RFC2119 boilerplate -->
    <!-- add any extra language your spec requires here -->
  </section>
</section>

<section class="informative" id="overview">
  <!--OddPage--><h2 aria-level="1" role="heading" id="h2_overview"><span class="secno">2. </span>Overview</h2><p><em>This section is non-normative.</em></p>
  <p>
    FIDO uses the concept of attestation to provide a cryptographic proof of the 
    <dfn id="dfn-authenticator">authenticator</dfn> [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>] model to the relying party.  When the authenticator is registered 
    to the relying party (RP), it generates a new authentication key pair 
    and includes the public key in the attestation message 
    (also known as key registration data object,  <dfn id="dfn-krd">KRD</dfn>).
    When using the ECDAA algorithm, the <a href="#dfn-krd" class="internalDFN">KRD</a> object is signed using <a href="#ecdaa-sign" class="sec-ref"><span class="secno">3.5</span> <span class="sec-title">ECDAA-Sign</span></a>.
  </p>
  <p>
    For privacy reasons, the authentication key pair is dedicated to one RP (to 
    an application identifier <dfn id="dfn-appid">AppID</dfn> [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>] to be more specific).  Consequently 
    the attestation method needs to provide the same level of unlinkability.  This is the reason
    why the FIDO ECDAA Algorithm doesn't use a basename (bsn) often found in other direct 
    anonymous attestation algorithms, e.g. [<cite><a class="bibref" href="#bib-BriCamChe2004-DAA">BriCamChe2004-DAA</a></cite>] or [<cite><a class="bibref" href="#bib-BFGSW-2011">BFGSW-2011</a></cite>].
  </p>
  <p>The authenticator encapsulates all user verification operations and cryptographic functions.
    An authenticator specific module (<dfn id="dfn-asm">ASM</dfn>) [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>] is used to provide a standardized 
    communication interface for authenticators.  The authenticator might be implemented in separate
    hardware or trusted execution environments.  The ASM is assumed to run in the normal operating 
    system (e.g. Android, Windows, ...).
  </p>

  <section id="scope">
    <h3 aria-level="2" role="heading" id="h3_scope"><span class="secno">2.1 </span>Scope</h3>
    <p>
      This document describes the FIDO ECDAA attestation algorithm in
      detail. 
    </p>
  </section>

  <section id="architecture-overview">
    <h3 aria-level="2" role="heading" id="h3_architecture-overview"><span class="secno">2.2 </span>Architecture Overview</h3>
    ECDAA attestation defines <a href="#global-ecdaa-system-parameters">global system parameters</a> 
    and <a href="#issuer-specific-ecdaa-parameters">issuer specific parameters</a>. 
    Both parameter sets need to be installed on the host, in the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> and in the FIDO Server.

    The ECDAA method consists of two steps:
    <ul>
      <li><a href="#outline-of-the-ecdaa-join-operation">ECDAA-Join</a> to be performed <em>before</em>
	the first FIDO Registration
	<ul>
	  <li>n = GetNonceFromECDAAIssuer()</li>
	  <li>(Q, c1, s1) = EcdaaJoin1(X, Y, n)</li>
	  <li>(A, B, C, D, s2, c2) = EcdaaIssuerJoin(Q, c1, s1)</li>
	  <li>EcdaaJoin2(A, B, C, D, c2, s2) // store cre=(A, B, C, D)</li>
	</ul>
      </li>
      <li>and the pair of <a href="#ecdaa-sign-operation">ECDAA-Sign</a> performed by the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> 
	and <a href="#ecdaa-verify-operation">ECDAA-Verify</a> performed by the FIDO Server 
	as part of the FIDO Registration.
	<ul>
	  <li>Client: Attestation = (signature, <a href="#dfn-krd" class="internalDFN">KRD</a>) = EcdaaSign(<a href="#dfn-appid" class="internalDFN">AppID</a>)</li>
	  <li>Server: success=EcdaaVerify(signature, <a href="#dfn-krd" class="internalDFN">KRD</a>, <a href="#dfn-appid" class="internalDFN">AppID</a>)</li>
	</ul>
      </li>
    </ul>
    <p>
      The technical implementation details of the ECDAA-Join step are out-of-scope for FIDO. 
      In this document we normatively specify the general algorithm to the extent required 
      for interoperability and we outline examples of some possible implementations for this step.
    </p>
    <p>
      The ECDAA-Sign and ECDAA-Verify steps and the encoding of the related ECDAA Signature
      are normatively specified in this document.  The generation and encoding of the <a href="#dfn-krd" class="internalDFN">KRD</a> object is defined 
      in other FIDO specifications.
    </p>
    
    <p>The algorithm and terminology are inspired by [<cite><a class="bibref" href="#bib-BFGSW-2011">BFGSW-2011</a></cite>].  The algorithm was modified in order to
      fix security weaknesses (e.g. as mentioned by [<cite><a class="bibref" href="#bib-ANZ-2013">ANZ-2013</a></cite>] and [<cite><a class="bibref" href="#bib-XYZF-2014">XYZF-2014</a></cite>]).
      Our algorithm proposes an improved task split for the sign operation while still being compatible
      to TPMv2 (without fixing the TPMv2 weaknesses in such case).
    </p>
  </section>
</section>


<section class="normativeDisclaimer" id="fido-ecdaa-attestation">
  <!--OddPage--><h2 aria-level="1" role="heading" id="h2_fido-ecdaa-attestation"><span class="secno">3. </span>FIDO ECDAA Attestation</h2><p><em>This section is normative.</em></p>

  <section id="object-encodings">
    <h3 aria-level="2" role="heading" id="h3_object-encodings"><span class="secno">3.1 </span>Object Encodings</h3>
    <p>We need to convert <code>BigNumber</code> and <code>ECPoint</code> objects to 
      byte strings using the following encoding functions:</p>


    <section id="encoding-bignumber-values-as-byte-strings-bignumbertob">
      <h4 aria-level="3" role="heading" id="h4_encoding-bignumber-values-as-byte-strings-bignumbertob"><span class="secno">3.1.1 </span>Encoding <code>BigNumber</code> values as byte strings (BigNumberToB)</h4>
      We use the I2OSP algorithm as defined in [<cite><a class="bibref" href="#bib-RFC3447">RFC3447</a></cite>] for converting big numbers to byte arrays.
      The bytes from the big endian encoded (non-negative) number <code>n</code> 
      will be copied right-aligned into the buffer area <code>b</code>.  
      The unused bytes will be set to 0.  Negative values will not occur due to the construction of the algorithms.

      <div class="example"><div class="example-title"><span>Example 1</span>: Converting BigNumber n to byte string b</div><pre class="example">b0 b1 b2 b3 b4 b5 b6 b7
 0  0 n0 n1 n2 n3 n4 n5</pre></div>

      The algorithm implemented in Java looks like this:
      <div class="example"><div class="example-title"><span>Example 2</span>: Algorithm for converting BigNumber to byte strings</div><pre class="example">ByteArray BigNumberToB(
      BigNumber inVal, // IN: number to convert
      int size         // IN: size of the output.
     )
{
  ByteArray buffer = new ByteArray(size);
  int oversize = size - inVal.length;
  if (oversize &lt; 0)
    return null;
  for (int i=overvize; i &gt; 0; i--)
     buffer[i] = 0;
  ByteCopy( inVal.bytes, &amp;buffer[oversize], inVal.length);
 return buffer;
}</pre></div>

    </section>
    
    <section id="encoding-ecpoint-values-as-byte-strings-ecpointtob">
      <h4 aria-level="3" role="heading" id="h4_encoding-ecpoint-values-as-byte-strings-ecpointtob"><span class="secno">3.1.2 </span>Encoding <code>ECPoint</code> values as byte strings (ECPointToB)</h4>
      We use the ANSI X9.62 Point-to-Octet-String [<cite><a class="bibref" href="#bib-ECDSA-ANSI">ECDSA-ANSI</a></cite>] conversion using the expanded format, i.e. 
      the format where the compression byte (i.e. 0x04 for expanded) is followed 
      by the encoding of the affine x coordinate,
      followed by the encoding of the affine y coordinate.

      <div class="example"><div class="example-title"><span>Example 3</span>: Converting ECPoint P to byte string</div><pre class="example">(x, y) = ECPointGetAffineCoordinates(P)
len = G1.byteLength
byte string = 0x04 | BigIntegerToB(x,len) | BigIntegerToB(y,len)</pre></div>

    </section>
    
    <section id="encoding-ecpoint2-values-as-byte-strings-ecpoint2tob">
      <h4 aria-level="3" role="heading" id="h4_encoding-ecpoint2-values-as-byte-strings-ecpoint2tob"><span class="secno">3.1.3 </span>Encoding <code>ECPoint2</code> values as byte strings (ECPoint2ToB)</h4>
      <p>
	The type <code>ECPoint2</code> denotes a point on the sextic twist of a BN elliptic curve over <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">F</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-19" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-3">F(q^2)</script>, 
	see section <a href="#supported-curves-for-ecdaa" class="sec-ref"><span class="secno">4.1</span> <span class="sec-title">Supported Curves for ECDAA</span></a>.
	Each <code>ECPoint2</code> is represented by a pair <code>(a, b)</code> of elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">F</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">q</span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-4">F(q)</script>.
      </p>
      The group zero element is always encoded (using the encoding rules as described below) 
      as a an element having all components set to zero (i.e. cx.a=0, cx.b=0, cy.a=0, cy.b=0).

      <p>
	We always assume normalized (non-zero) ECPoint2 values (i.e. cz = 1) before encoding them.  
	Non-zero values are encoded using the expanded format (i.e. 0x04 for expanded) 
	followed by the cx followed by the cy value.
	This leads to the concatenation of 0x04 followed by the first element (<code>cx.a</code>) and 
	second element (<code>cx.b</code>) of the pair of cx followed by the
	first element (<code>cy.a</code>) and second element (<code>cy.b</code>) of the pair of cy.  
	All individual numbers are padded to the same length 
	(i.e. the maximum byte length of all relevant 4 numbers).
      </p>
      <div class="example"><div class="example-title"><span>Example 4</span>: Converting ECPoint2 P2 to byte string</div><pre class="example">(cx, cy) = ECPointGetAffineCoordinates(P2)
len = G2.byteLength
byte string = 0x04 | BigIntegerToB(cx.a,len) | BigIntegerToB(cx.b,len) 
              | BigIntegerToB(cy.a,len) | BigIntegerToB(cy.b,len)</pre></div>
      

    </section>

  </section>

  <section id="global-ecdaa-system-parameters">
    <h3 aria-level="2" role="heading" id="h3_global-ecdaa-system-parameters"><span class="secno">3.2 </span>Global ECDAA System Parameters</h3>
    <ol>
	  <li>Groups <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-5">G_1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-msubsup" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-6">G_2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-msubsup" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-37" style="vertical-align: -0.4em;">T</span></span></span></span><script type="math/tex" id="MathJax-Element-7">G_T</script>, of sufficiently large prime order <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">p</span></span></span><script type="math/tex" id="MathJax-Element-8">p</script></li>
	  <li>Two generators <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-msubsup" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-43" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-9">P_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-47" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-10">P_2</script>, such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-48"><span class="MJXp-msubsup" id="MJXp-Span-49"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-51" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-msubsup" id="MJXp-Span-54"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-56" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">⟩</span></span></span><script type="math/tex" id="MathJax-Element-11">G_1 = \langle P_1\rangle </script> 
	    and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-58"><span class="MJXp-msubsup" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-61" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-66" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">⟩</span></span></span><script type="math/tex" id="MathJax-Element-12">G_2 = \langle P_2 \rangle</script></li>
	  <li> A bilinear pairing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">e</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-77" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">T</span></span></span></span><script type="math/tex" id="MathJax-Element-13">e: G_1 \times G_2 \rightarrow G_T</script>.  
	    We propose the use of "ate" pairing (see [<cite><a class="bibref" href="#bib-BarNae-2006">BarNae-2006</a></cite>]).
	    For example source code on this topic, see <a href="https://code.google.com/p/bnpairings/">BNPairings</a>.
	  </li>
	  <li>Hash function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">H</span></span></span><script type="math/tex" id="MathJax-Element-14">H</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">H</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-88">0</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-90">1</span><span class="MJXp-msubsup" id="MJXp-Span-91"><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0.05em;">}</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-93" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">Z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-15">H: \{0, 1\}^* \rightarrow Z_p</script>. </li>
	  <li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-102" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">p</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">H</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-16">(G_1, P_1, p, H)</script> are installed in all authenticators implementing FIDO ECDAA attestation.</li>
	</ol>

    <p><b>Definition of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-112"><span class="MJXp-msubsup" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-115" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-119" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-123" style="vertical-align: -0.4em;">T</span></span></span></span><script type="math/tex" id="MathJax-Element-17">G_1, G_2, G_T</script>, Pairings and hash function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">H</span></span></span><script type="math/tex" id="MathJax-Element-18">H</script></b></p>  
    See section <a href="#supported-curves-for-ecdaa" class="sec-ref"><span class="secno">4.1</span> <span class="sec-title">Supported Curves for ECDAA</span></a>.

  </section>

  <section id="issuer-specific-ecdaa-parameters">
    <h3 aria-level="2" role="heading" id="h3_issuer-specific-ecdaa-parameters"><span class="secno">3.3 </span>Issuer Specific ECDAA Parameters</h3>
    Issuer Parameters parI
    <ol>
      <li>Randomly generated issuer private key <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">k</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">x</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">y</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-19">isk=(x,y)</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">x</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">y</span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">D</span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">p</span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-20">[x,y = RAND(p)]</script>.</li>
      <li>Issuer public key <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">X</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">Y</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-21">(X,Y)</script>, with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">X</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">x</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-161">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-22">X = P_2^x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">Y</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">y</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-168">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-23">Y = P_2^y</script>.</li>
      <li>A proof that the issuer key was correctly computed
      <ol>
      	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-msubsup" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-173" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">D</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">p</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-24">r_x = RAND(p)</script></li>
	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-msubsup" id="MJXp-Span-183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-185" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">D</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">p</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-25">r_y = RAND(p)</script></li>
      	<li>ECPoint2 <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">U</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-197" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-msubsup" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-205" style="vertical-align: -0.4em;">x</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-201">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-26">U_x = P_2^{r_x}</script>
	</li>
	<li>ECPoint2 <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208" style="margin-right: 0.05em;">U</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-214"><span class="MJXp-msubsup" id="MJXp-Span-215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-217" style="vertical-align: -0.4em;">y</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-213">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-27">U_y = P_2^{r_y}</script></li>
      	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">c</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">H</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224" style="margin-right: 0.05em;">U</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-225" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mrow" id="MJXp-Span-226"><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229" style="margin-right: 0.05em;">U</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-230" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mrow" id="MJXp-Span-231"><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-235" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-236"><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">X</span><span class="MJXp-mrow" id="MJXp-Span-239"><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">Y</span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-28">c = H(U_x | U_y | P_2 | X | Y)</script></li>
      	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-msubsup" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-246" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-250" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">c</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">x</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-255"><span class="MJXp-mspace" id="MJXp-Span-256" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-258">mod</span><span class="MJXp-mspace" id="MJXp-Span-259" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">p</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-29">s_x = r_x + c \cdot x \pmod{p}</script></li>
	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-262"><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-265" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-269" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">c</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">y</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-274"><span class="MJXp-mspace" id="MJXp-Span-275" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-277">mod</span><span class="MJXp-mspace" id="MJXp-Span-278" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">p</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-30">s_y = r_y + c \cdot y \pmod{p}</script></li>
      </ol>
      </li>
      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">k</span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">X</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">Y</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">c</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-294" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-298" style="vertical-align: -0.4em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-31">ipk = X, Y, c, s_x, s_y</script></li>
    </ol>
    
    Whenever a party uses ipk for the first time, it must first verify that it was correctly generated:
    <p>
      <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">H</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-305"><span class="MJXp-msubsup" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-308" style="vertical-align: -0.4em;">x</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-304">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-312" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-313">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">c</span></span></span><span class="MJXp-mrow" id="MJXp-Span-315"><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-320"><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-323" style="vertical-align: -0.4em;">y</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-319">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">Y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-327" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-328">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">c</span></span></span><span class="MJXp-mrow" id="MJXp-Span-330"><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-334" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-335"><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">X</span><span class="MJXp-mrow" id="MJXp-Span-338"><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">Y</span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-342"><span class="MJXp-munderover" id="MJXp-Span-343"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-346" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-347">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-344"><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">c</span></span></span><script type="math/tex" id="MathJax-Element-32">H(P_2^{s_x} \cdot X^{-c} | P_2^{s_y} \cdot Y^{-c} | P_2 | X | Y) \stackrel{?}{=} c</script>
    </p>
    <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_1"><span>Note</span></div><div class="review">
      <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-353"><span class="MJXp-msubsup" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-356" style="vertical-align: -0.4em;">x</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-352">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-360" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-361">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-367"><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-370" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-371">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">x</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-366">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-378"><span class="MJXp-mo" id="MJXp-Span-379">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">x</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-377">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-386"><span class="MJXp-msubsup" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-389" style="vertical-align: -0.4em;">x</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-385">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392" style="margin-right: 0.05em;">U</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-393" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-33"> P_2^{s_x} \cdot X^{-c} = P_2^{r_x + c x} \cdot P_2^{-c x} = P_2^{r_x} = U_x </script></p>
      <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-394"><span class="MJXp-msubsup" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-398"><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-401" style="vertical-align: -0.4em;">y</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-397">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404" style="margin-right: 0.05em;">Y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-405" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-406">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-412"><span class="MJXp-msubsup" id="MJXp-Span-413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-415" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-416">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-411">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-423"><span class="MJXp-mo" id="MJXp-Span-424">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-422">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-431"><span class="MJXp-msubsup" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-434" style="vertical-align: -0.4em;">y</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-430">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437" style="margin-right: 0.05em;">U</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-438" style="vertical-align: -0.4em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-34"> P_2^{s_y} \cdot Y^{-c} = P_2^{r_y + c y} \cdot P_2^{-c y} = P_2^{r_y} = U_y </script></p>
    </div></div>
	
    <p>The ECDAA-Issuer public key ipk <em class="rfc2119" title="MUST">MUST</em> be dedicated to a single <a href="#dfn-authenticator" class="internalDFN">authenticator</a> model.</p>

  </section>

  <section id="ecdaa-join">
    <h3 aria-level="2" role="heading" id="h3_ecdaa-join"><span class="secno">3.4 </span>ECDAA-Join</h3>
    
    <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_2"><span>Note</span></div><div class="">
      <p>One ECDAA-Join operation is required once in the lifetime of an <a href="#dfn-authenticator" class="internalDFN">authenticator</a> prior to the first
	registration of a credential.</p>
    </div></div>
    
    <p>
      In order to use ECDAA, the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> must first receive ECDAA credentials from an ECDAA-Issuer.  
      This is done by the ECDAA-Join operation.  
      This operation needs to be performed a single time (before the first credential registration can take place).
      
      After the ECDAA-Join, the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> will use the ECDAA-Sign operation as part of each FIDO Registration. 
      The ECDAA-Issuer is not involved in this step.  ECDAA plays no role in 
      FIDO Authentication / Transaction Confirmation operations.
    </p>
    
    <p>
      In order to use ECDAA, (at least) one ECDAA-Issuer is needed.  The approach specified in this document
      easily scales to multiple ECDAA-Issuers, e.g. one per <a href="#dfn-authenticator" class="internalDFN">authenticator</a> vendor.  
      FIDO lets the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> vendor choose any ECDAA-Issuer (similar to his current freedom for selecting any 
      PKI infrastructure/service provider to issuing attestation certificates required for FIDO Basic Attestation).
      </p><ul>
	<li>All ECDAA-Join operations (of the related authenticators) are 
	  performed with one of the ECDAA-Issuer entities.
	</li>
	<li>Each ECDAA-Issuer has a set of public parameters, i.e. ECDAA public key material. 
	  The related Attestation Trust Anchor is contained in the metadata of 
	  each <a href="#dfn-authenticator" class="internalDFN">authenticator</a> model identified by its AAGUID.
	</li>
      </ul>
    <p></p>
    <p>
      There are two different implementation options relevant for the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> Vendors 
      (the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> vendor can freely choose them):
      </p><ol>
	<li>In-Factory ECDAA-Join</li>
	<li>Remote ECDAA-Join and</li>
      </ol>
    <p></p>
    
    <p>
      In the first case, physical proximity is used to locally establish 
      the trust between the ECDAA-Issuer and the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> 
      (e.g. using a key provisioning station in a production line).  
      There is no requirement for the ECDAA-Issuer to operate an online web service.
    </p>
    <p>
      In the second case, some credential is required to remotely establish the 
      trust between the ECDAA-Issuer and the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>.  
      As this operation is performed once and only with a single ECDAA-Issuer, 
      privacy is preserved and an <a href="#dfn-authenticator" class="internalDFN">authenticator</a> specific credential can and should be used. 
    </p>
    
    <p>Not all ECDAA authenticators might be able to add their <a href="#dfn-authenticator" class="internalDFN">authenticator</a> 
      model IDs (e.g. AAGUID) to the registration assertion (e.g. TPMs). 
      In all cases, the ECDAA-Issuer will be able to derive the exact the 
      <a href="#dfn-authenticator" class="internalDFN">authenticator</a> model from either the credential or the physically 
      proximiate <a href="#dfn-authenticator" class="internalDFN">authenticator</a>.  So the ECDAA-Issuer root key <em class="rfc2119" title="MUST">MUST</em>  
      be dedicated to a single <a href="#dfn-authenticator" class="internalDFN">authenticator</a> model.
    </p>
    
    <section class="normativeDisclaimer" id="ecdaa-join-algorithm">
      <h4 aria-level="3" role="heading" id="h4_ecdaa-join-algorithm"><span class="secno">3.4.1 </span>ECDAA-Join Algorithm</h4><p><em>This section is normative.</em></p>
      <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_3"><span>Note</span></div><div class="">
	<p>If this join is not in-factory, the value Q must be authenticated by the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>. 
	  Upon receiving this value, the issuer must verify that this <a href="#dfn-authenticator" class="internalDFN">authenticator</a> did not join before.</p>
      </div></div>
      <ol>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> asks the issuer for a nonce.</li>
	<li>The issuer chooses a nonce BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">n</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">D</span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">p</span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-35">n = RAND(p)</script> and sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">n</span></span></span><script type="math/tex" id="MathJax-Element-36">n</script> via the <a href="#dfn-asm" class="internalDFN">ASM</a> to the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>.</li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> chooses and stores the ECDAA private key BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">k</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">D</span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">p</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-37">sk = RAND(p)</script> </li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> computes its ECDAA public key ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">Q</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">k</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-467">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-38">Q = P_1^{sk}</script></li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> proves knowledge of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">k</span></span></span><script type="math/tex" id="MathJax-Element-39">sk</script> as follows
	  <ol>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-msubsup" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-477" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">D</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">p</span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">r_1 = RAND(p)</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-msubsup" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-489" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-494"><span class="MJXp-msubsup" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-497" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-493">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-41">U_1 = P_1^{r_1}</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-msubsup" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-501" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">H</span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-507" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-508"><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-512" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-513"><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">Q</span><span class="MJXp-mrow" id="MJXp-Span-516"><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">n</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-42">c_1 = H(U_1 | P_1 | Q | n)</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-msubsup" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-523" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-527" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-531" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">k</span></span></span><script type="math/tex" id="MathJax-Element-43">s_1 = r_1 + c_1 \cdot sk</script></li>
	  </ol>
	</li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">Q</span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-540" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-44">Q, c_1, s_1</script> via the <a href="#dfn-asm" class="internalDFN">ASM</a> to the issuer</li>
	<li>The issuer verifies that the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> is "authentic" and that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">Q</span></span></span><script type="math/tex" id="MathJax-Element-45">Q</script> 
	  was indeed generated by the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>.
	  In the case of an in-factory Join, this might be trivial; in the case of a remote 
	  Join this typically requires the use of other cryptographic methods.  
	  Since ECDAA-Join is a one-time operation, unlinkability is not a concern for that.
	</li>
	<li>The issuer verifies that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">Q</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-552" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-46">Q \in G_1</script> and 
	  verifies <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">H</span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-559"><span class="MJXp-msubsup" id="MJXp-Span-560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-562" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-558">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-566" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-567">−</span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-571"><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-575" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-576"><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">Q</span><span class="MJXp-mrow" id="MJXp-Span-579"><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">n</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-583"><span class="MJXp-munderover" id="MJXp-Span-584"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-587" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-588">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-585"><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-591" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-47">H(P_1^{s_1} \cdot Q^{-c_1} | P_1 | Q | n) \stackrel{?}{=} c_1</script> 
	  (check proof-of-possession of private key).
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_4"><span>Note</span></div><div class="review">
	    <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-msubsup" id="MJXp-Span-593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-596"><span class="MJXp-msubsup" id="MJXp-Span-597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-599" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-595">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-603" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-604">−</span><span class="MJXp-msubsup" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-607" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-612"><span class="MJXp-msubsup" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-615" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-616">+</span><span class="MJXp-msubsup" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-619" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">k</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-611">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-622" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-625" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-626">−</span><span class="MJXp-msubsup" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-629" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-634"><span class="MJXp-msubsup" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-637" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-638">+</span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-641" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">k</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-633">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-648"><span class="MJXp-mo" id="MJXp-Span-649">−</span><span class="MJXp-msubsup" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-652" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">k</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-647">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-msubsup" id="MJXp-Span-660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-662" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-658">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-48"> P_1^{s_1} \cdot Q^{-c_1} = P_1^{r_1 + c_1 sk} \cdot Q^{-c_1} 
	      = P_1^{r_1 + c_1 sk} \cdot P_1^{-c_1 sk}
	      = P_1^{r_1} = U_1 </script>
	    </p>
	  </div></div>
	</li>
	<li>The issuer creates credential <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-667"><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">A</span><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">B</span><span class="MJXp-mo" id="MJXp-Span-672" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">C</span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">D</span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-49">(A, B, C, D)</script> as follows
	  <ol>
    	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-msubsup" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-680" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">D</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">p</span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-50">l_J = RAND(p)</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">A</span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-695"><span class="MJXp-msubsup" id="MJXp-Span-696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-698" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-694">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-51">A = P_1^{l_J}</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">B</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-704" style="vertical-align: 0.5em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-52">B = A^y</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706">C</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-710" style="vertical-align: 0.5em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-714" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">y</span><span class="MJXp-msubsup" id="MJXp-Span-717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-719" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-53">C = A^x \cdot Q^{x y l_J}</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">D</span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-725" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-728" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">y</span></span></span></span></span><script type="math/tex" id="MathJax-Element-54">D = Q^{l_J y}</script></li>
	</ol></li>
	<li> The issuer proves that it computed this credential correctly:
	  <ol>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-730"><span class="MJXp-msubsup" id="MJXp-Span-731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-733" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">D</span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">p</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">r_2 = RAND(p)</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-742"><span class="MJXp-msubsup" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-745" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-750"><span class="MJXp-msubsup" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-753" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-749">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-56">U_2 = P_1^{r_2}</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-754"><span class="MJXp-msubsup" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-757" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-761" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-764" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-57">V_2 = Q^{r_2}</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-765"><span class="MJXp-msubsup" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-768" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">H</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-774" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-775"><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-779" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-780"><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-784" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-785"><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">B</span><span class="MJXp-mrow" id="MJXp-Span-788"><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">Q</span><span class="MJXp-mrow" id="MJXp-Span-791"><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">D</span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-58">c_2 = H(U_2 | V_2 | P_1 | B | Q | D)</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-795"><span class="MJXp-msubsup" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-798" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-802" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-806" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-810" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">y</span></span></span><script type="math/tex" id="MathJax-Element-59">s_2 = r_2 + c_2 \cdot l_J \cdot y</script></li>
	  </ol>
	</li>
	<li>The issuer sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">A</span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">B</span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">C</span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">D</span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-824" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-828" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-60">A, B, C, D, c_2, s_2</script> to the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>.	</li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> checks that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">A</span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">B</span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">C</span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">D</span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-840" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-61">A, B, C, D \in G_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">A</span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mn" id="MJXp-Span-845" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-846" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-849" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-62">A \neq 1_{G_1}</script></li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">H</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-856"><span class="MJXp-msubsup" id="MJXp-Span-857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-859" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-855">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-863" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-864">−</span><span class="MJXp-msubsup" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-867" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-868"><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-872" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-875" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-876" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-877"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-879" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-880">−</span><span class="MJXp-msubsup" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-883" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-884"><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-888" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-889"><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">B</span><span class="MJXp-mrow" id="MJXp-Span-892"><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">Q</span><span class="MJXp-mrow" id="MJXp-Span-895"><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">D</span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-899"><span class="MJXp-munderover" id="MJXp-Span-900"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-903" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-904">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-901"><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-907" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-63">H(P_1^{s_2} \cdot B^{-c_2} | Q^{s_2} \cdot D^{-c_2} |
	  P_1 | B | Q | D) \stackrel{?}{=} c_2</script> </li>
	<div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_5"><span>Note</span></div><div class="review">
	  <p>
	    <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-msubsup" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-912"><span class="MJXp-msubsup" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-915" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-911">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-919" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-920">−</span><span class="MJXp-msubsup" id="MJXp-Span-921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-923" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-928"><span class="MJXp-msubsup" id="MJXp-Span-929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-931" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-927">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-932" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-936"><span class="MJXp-msubsup" id="MJXp-Span-937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-939" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-940">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-943" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-944">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-935">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-949" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-950">−</span><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-953" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-957" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-961" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-964" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-968" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-969">−</span><span class="MJXp-msubsup" id="MJXp-Span-970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-972" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-976" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-64">P_1^{s_2} \cdot B^{-c_2} = P_1^{r_2} \cdot P_1^{c_2 \cdot l_J \cdot y} \cdot B^{-c_2} 
	    = U_2 \cdot B^{c_2} \cdot B^{-c_2} = U_2</script>
	  </p>
	  <p>	
	    <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-977"><span class="MJXp-msubsup" id="MJXp-Span-978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-980" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-983" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-987" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-988">−</span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-991" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-995" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-998" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1002" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1005" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1006">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1009" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-1010">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">y</span></span></span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1015" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1016">−</span><span class="MJXp-msubsup" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1019" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1020" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1023" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1027" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1030" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1034" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1035">−</span><span class="MJXp-msubsup" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1038" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1042" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-65">Q^{s_2} \cdot D^{-c_2} = Q^{r_2} \cdot Q^{c_2 \cdot l_J \cdot y} \cdot D^{-c_2} 
	    = V_2 \cdot D^{c_2} \cdot D^{-c_2} = V_2</script>
	</p>
	</div></div>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">e</span><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">A</span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">Y</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1050"><span class="MJXp-munderover" id="MJXp-Span-1051"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1054" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1055">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1052"><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">e</span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">B</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1062" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-66">e(A, Y) \stackrel{?}{=} e(B, P_2)</script> 
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_6"><span>Note</span></div><p class="review"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">e</span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">A</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">Y</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">e</span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1077"><span class="MJXp-msubsup" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1080" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1076">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1082"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">y</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1084">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1086" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-67">e(A, Y) = e(P_1^{l_J}, P_2^y)</script>; 
	    <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">e</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">B</span><span class="MJXp-mo" id="MJXp-Span-1091" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1094" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">e</span><span class="MJXp-mo" id="MJXp-Span-1098" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1101" style="vertical-align: 0.5em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1105" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">e</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">y</span><span class="MJXp-msubsup" id="MJXp-Span-1115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1117" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1112">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1121" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-68">e(B, P_2) = e(A^y, P_2) = e(P_1^{y l_J}, P_2)</script>
	  </p></div>
	</li>
	<li>and the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">e</span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">C</span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1130" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-munderover" id="MJXp-Span-1133"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1136" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1137">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1134"><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">e</span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">A</span><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">D</span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">X</span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">e(C, P_2) \stackrel{?}{=} e(A \cdot D, X)</script>
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_7"><span>Note</span></div><p class="review"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">e</span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">C</span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1153" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">e</span><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1160" style="vertical-align: 0.5em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1164" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">y</span><span class="MJXp-msubsup" id="MJXp-Span-1167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1169" style="vertical-align: -0.4em;">J</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1173" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-70">e(C, P_2) = e(A^x \cdot Q^{x y l_J}, P_2)</script>;
	    <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">e</span><span class="MJXp-mo" id="MJXp-Span-1177" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">A</span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">D</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">X</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">e</span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">A</span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1191" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">y</span><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1195" style="vertical-align: -0.4em;">J</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">x</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1199">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-71">e(A \cdot D, X) = e(A \cdot Q^{y l_J}, P_2^x) </script>
	  </p></div>
	</li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> stores credential <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">A</span><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">B</span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">C</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">D</span></span></span><script type="math/tex" id="MathJax-Element-72">A, B, C, D</script></li>
      </ol>
    </section>
    
    <section class="informative" id="ecdaa-join-split-between-authenticator-and-asm">
      <h4 aria-level="3" role="heading" id="h4_ecdaa-join-split-between-authenticator-and-asm"><span class="secno">3.4.2 </span>ECDAA-Join Split between Authenticator and ASM</h4><p><em>This section is non-normative.</em></p>
      <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_8"><span>Note</span></div><div class="">
	<p>If this join is not in-factory, the value Q must be authenticated by the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>. 
	  Upon receiving this value, the issuer must verify that this <a href="#dfn-authenticator" class="internalDFN">authenticator</a> did not join before.</p>
      </div></div>
      <ol>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> asks the issuer for a nonce.</li>
	<li>The issuer chooses a nonce BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">n</span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">D</span><span class="MJXp-mo" id="MJXp-Span-1217" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">p</span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-73">n = RAND(p)</script> and sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">n</span></span></span><script type="math/tex" id="MathJax-Element-74">n</script> to the <a href="#dfn-asm" class="internalDFN">ASM</a>.</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> forwards <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">n</span></span></span><script type="math/tex" id="MathJax-Element-75">n</script> to the <a href="#dfn-authenticator" class="internalDFN">authenticator</a></li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> chooses and stores the private key BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">k</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">D</span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">p</span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-76">sk = RAND(p)</script></li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> computes its ECDAA public key ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">Q</span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">k</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1240">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-77">Q = P_1^{sk}</script></li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> proves knowledge of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">k</span></span></span><script type="math/tex" id="MathJax-Element-78">sk</script> as follows
	  <ol>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1247"><span class="MJXp-msubsup" id="MJXp-Span-1248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1250" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">D</span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">p</span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-79">r_1 = RAND(p)</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1259"><span class="MJXp-msubsup" id="MJXp-Span-1260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1262" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1263" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1267"><span class="MJXp-msubsup" id="MJXp-Span-1268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1270" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1266">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-80">U_1 = P_1^{r_1}</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1271"><span class="MJXp-msubsup" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1274" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">H</span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1280" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1281"><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1285" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1286"><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">Q</span><span class="MJXp-mrow" id="MJXp-Span-1289"><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">n</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-81">c_1 = H(U_1 | P_1 | Q | n)</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1293"><span class="MJXp-msubsup" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1296" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1297" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1300" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1304" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">k</span></span></span><script type="math/tex" id="MathJax-Element-82">s_1 = r_1 + c_1 \cdot sk</script></li>
	  </ol>
	</li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">Q</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1313" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1317" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-83">Q, c_1, s_1</script> to the <a href="#dfn-asm" class="internalDFN">ASM</a>, who forwards it to the issuer.</li>
	<li>The issuer verifies that the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> is "authentic" and that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">Q</span></span></span><script type="math/tex" id="MathJax-Element-84">Q</script> was 
	  indeed generated by the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>.
	  In the case of an in-factory Join, this might be trivial; in the case of a remote 
	  Join this typically requires the use of other cryptographic methods.  
	  Since ECDAA-Join is a one-time operation, unlinkability is not a concern for that.
	</li>
	<li>The issuer verifies that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">Q</span><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1325" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-85">Q \in G_1</script> 
	  and verifies <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">H</span><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1332"><span class="MJXp-msubsup" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1335" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1331">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1339" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1340">−</span><span class="MJXp-msubsup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1343" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1344"><span class="MJXp-mo" id="MJXp-Span-1345" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1348" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1349"><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">Q</span><span class="MJXp-mrow" id="MJXp-Span-1352"><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">n</span><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1356"><span class="MJXp-munderover" id="MJXp-Span-1357"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1360" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1361">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1358"><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1364" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-86">H(P_1^{s_1} \cdot Q^{-c_1} | P_1 | Q | n) \stackrel{?}{=} c_1</script>.</li>
	<li>The issuer creates credential <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1365"><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">A</span><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">B</span><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">C</span><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">D</span><span class="MJXp-mo" id="MJXp-Span-1374" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-87">(A, B, C, D)</script> as follows
	  <ol>
    	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1375"><span class="MJXp-msubsup" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1378" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-1379" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">D</span><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">p</span><span class="MJXp-mo" id="MJXp-Span-1386" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-88">l_J = RAND(p)</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">A</span><span class="MJXp-mo" id="MJXp-Span-1389" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1393"><span class="MJXp-msubsup" id="MJXp-Span-1394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1396" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1392">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-89">A = P_1^{l_J}</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">B</span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1402" style="vertical-align: 0.5em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-90">B = A^y</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">C</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1408" style="vertical-align: 0.5em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1412" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">y</span><span class="MJXp-msubsup" id="MJXp-Span-1415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1417" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-91">C = A^x \cdot Q^{x y l_J}</script></li>
    	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">D</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1423" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1426" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">y</span></span></span></span></span><script type="math/tex" id="MathJax-Element-92">D = Q^{l_J y}</script></li>
	  </ol>
	</li>
	<li> The issuer proves that it computed this credential correctly:
	  <ol>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1428"><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1431" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">D</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">p</span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-93">r_2 = RAND(p)</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-msubsup" id="MJXp-Span-1441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1443" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1448"><span class="MJXp-msubsup" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1451" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1447">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-94">U_2 = P_1^{r_2}</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1452"><span class="MJXp-msubsup" id="MJXp-Span-1453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1455" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1459" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1462" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-95">V_2 = Q^{r_2}</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1463"><span class="MJXp-msubsup" id="MJXp-Span-1464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1466" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">H</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1472" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1473"><span class="MJXp-mo" id="MJXp-Span-1474" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1477" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1482" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1483"><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">B</span><span class="MJXp-mrow" id="MJXp-Span-1486"><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">Q</span><span class="MJXp-mrow" id="MJXp-Span-1489"><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">D</span><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-96">c_2 = H(U_2 | V_2 | P_1 | B | Q | D)</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-msubsup" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1496" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1500" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1501" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1504" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1508" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">y</span></span></span><script type="math/tex" id="MathJax-Element-97">s_2 = r_2 + c_2 \cdot l_J \cdot y</script></li>
	  </ol>
	</li>
	<li>The issuer sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">A</span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">B</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">C</span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">D</span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1522" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1526" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-98">A, B, C, D, c_2, s_2</script> to the <a href="#dfn-asm" class="internalDFN">ASM</a>. 
	  The issuer authenticates <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">B</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">D</span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1534" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1538" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-99">B, D, c_2, s_2</script> such that the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> can 
	  verify they were created by the issuer.
	</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> checks that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">A</span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">B</span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">C</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">D</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1550" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-100">A, B, C, D \in G_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">A</span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mn" id="MJXp-Span-1555" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1559" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-101">A \neq 1_{G_1}</script></li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">H</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1566"><span class="MJXp-msubsup" id="MJXp-Span-1567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1569" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1565">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1573" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1574">−</span><span class="MJXp-msubsup" id="MJXp-Span-1575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1577" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1578"><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1582" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1585" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1586" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1589" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1590">−</span><span class="MJXp-msubsup" id="MJXp-Span-1591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1593" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1594"><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1598" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1599"><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">B</span><span class="MJXp-mrow" id="MJXp-Span-1602"><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">Q</span><span class="MJXp-mrow" id="MJXp-Span-1605"><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">D</span><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1609"><span class="MJXp-munderover" id="MJXp-Span-1610"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1613" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1614">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1611"><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1617" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-102">H(P_1^{s_2} \cdot B^{-c_2} | Q^{s_2} \cdot D^{-c_2} | P_1 | B | Q | D) \stackrel{?}{=} c_2</script> </li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">e</span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">A</span><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">Y</span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1625"><span class="MJXp-munderover" id="MJXp-Span-1626"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1629" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1630">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1627"><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">e</span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">B</span><span class="MJXp-mo" id="MJXp-Span-1634" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1637" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-103">e(A, Y) \stackrel{?}{=} e(B, P_2)</script></li>
	<li>and the <a href="#dfn-asm" class="internalDFN">ASM</a> checks that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">e</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">C</span><span class="MJXp-mo" id="MJXp-Span-1643" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1646" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1648"><span class="MJXp-munderover" id="MJXp-Span-1649"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1652" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1653">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1650"><span class="MJXp-mo" id="MJXp-Span-1651" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">e</span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">A</span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">D</span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">X</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-104">e(C, P_2) \stackrel{?}{=} e(A \cdot D, X)</script>
	</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> stores <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">A</span><span class="MJXp-mo" id="MJXp-Span-1664" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">B</span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">C</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">D</span></span></span><script type="math/tex" id="MathJax-Element-105">A, B, C, D</script> and sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">B</span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">D</span><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1677" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1681" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-106">B, D, c_2, s_2</script> to the <a href="#dfn-authenticator" class="internalDFN">authenticator</a></li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">B</span><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">D</span><span class="MJXp-mo" id="MJXp-Span-1686" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1689" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-107">B, D \in G_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">B</span><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-1693"><span class="MJXp-mn" id="MJXp-Span-1694" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1695" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1698" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-108">B \neq 1_{G_1}</script>, 
	  and verifies that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">B</span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">D</span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1706" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1710" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-109">B, D, c_2, s_2</script> were sent by the issuer.</li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">H</span><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1717"><span class="MJXp-msubsup" id="MJXp-Span-1718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1720" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1716">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1724" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1725">−</span><span class="MJXp-msubsup" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1728" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1729"><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1733" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1736" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1740" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1741">−</span><span class="MJXp-msubsup" id="MJXp-Span-1742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1744" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1745"><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1749" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1750"><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">B</span><span class="MJXp-mrow" id="MJXp-Span-1753"><span class="MJXp-mo" id="MJXp-Span-1754" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">Q</span><span class="MJXp-mrow" id="MJXp-Span-1756"><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">D</span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1760"><span class="MJXp-munderover" id="MJXp-Span-1761"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1764" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1765">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1762"><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1768" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-110">H(P_1^{s_2} \cdot B^{-c_2} | Q^{s_2} \cdot D^{-c_2} | P_1 | B | Q | D) 
	  \stackrel{?}{=} c_2</script> </li>
	<li>The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> stores <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">B</span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">D</span></span></span><script type="math/tex" id="MathJax-Element-111">B, D</script> and ignores further join requests.
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_9"><span>Note</span></div><p class="">These values belong to the ECDAA secret key <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">k</span></span></span><script type="math/tex" id="MathJax-Element-112">sk</script>.  
	    They should persist even in the case of a factory reset.</p></div>
	</li>
      </ol>
    </section>
    
    <section class="informative" id="ecdaa-join-split-between-tpm-and-asm">
      <h4 aria-level="3" role="heading" id="h4_ecdaa-join-split-between-tpm-and-asm"><span class="secno">3.4.3 </span>ECDAA-Join Split between TPM and ASM</h4><p><em>This section is non-normative.</em></p>
      <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_10"><span>Note</span></div><div class="">
	<p>The Endorsement key credential (EK-C) and TPM2_ActivateCredentials are used for supporting the remote Join.
	</p>
      </div></div>

      <p>This description is based on the principles described in [<cite><a class="bibref" href="#bib-TPMv2-Part1">TPMv2-Part1</a></cite>] section 24
	  and [<cite><a class="bibref" href="#bib-Arthur-Challener-2015">Arthur-Challener-2015</a></cite>], page 109 ("Activating a Credential").
      </p>
      <ol>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> asks the ECDAA Issuer for a nonce.</li>
	<li>The ECDAA Issue chooses a nonce BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">n</span><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">D</span><span class="MJXp-mo" id="MJXp-Span-1783" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">p</span><span class="MJXp-mo" id="MJXp-Span-1785" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-113">n = RAND(p)</script> and sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">n</span></span></span><script type="math/tex" id="MathJax-Element-114">n</script> to the <a href="#dfn-asm" class="internalDFN">ASM</a>.</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a>
	  <ol>
	    <li>instructs the TPM to create a restricted key by 
	      calling TPM2_Create, giving the public key template <code>TPMT_PUBLIC</code> [<cite><a class="bibref" href="#bib-TPMv2-Part2">TPMv2-Part2</a></cite>]
	      (including the public key <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">Q</span></span></span><script type="math/tex" id="MathJax-Element-115">Q</script> in field <code>unique</code>) to the <a href="#dfn-asm" class="internalDFN">ASM</a>.
	    </li>
	    <li>retrieves TPM Endorsement Key Certificate (EK-C) from the TPM</li>
	    <li>calls TPM2_Commit(keyhandle, P1, s2, y2) where keyhandle is the handle of the restricted key
	      generated before (see above), P1 is set to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1790"><span class="MJXp-msubsup" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1793" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-116">P_1</script>, and s2 and y2 are left empty. This call returns
	      K, L, E, and ctr; where K and L will be empty.</li>
	    <li>computes BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1794"><span class="MJXp-msubsup" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1797" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1798" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">H</span><span class="MJXp-mo" id="MJXp-Span-1800" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">E</span><span class="MJXp-mrow" id="MJXp-Span-1802"><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1806" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1807"><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">Q</span><span class="MJXp-mrow" id="MJXp-Span-1810"><span class="MJXp-mo" id="MJXp-Span-1811" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">n</span><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-117">c_1 = H(E | P_1 | Q | n)</script></li>
	    <li>call TPM2_Sign(<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1814"><span class="MJXp-msubsup" id="MJXp-Span-1815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1817" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-118">c_1</script>, ctr), returning <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1818"><span class="MJXp-msubsup" id="MJXp-Span-1819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1821" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-119">s_1</script>.</li>
	    <li>sends EK-C, <code>TPMT_PUBLIC</code> (including <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">Q</span></span></span><script type="math/tex" id="MathJax-Element-120">Q</script> in field <code>unique</code>), <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1824"><span class="MJXp-msubsup" id="MJXp-Span-1825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1827" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1831" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-121">c_1, s_1</script>
	      to the ECDAA Issuer.</li>
	  </ol>
	</li>
	<li>The ECDAA Issuer 
	  <ol>
	    <li>verifies EK-C and its certificate chain. As a result the ECDAA Issuer 
	      knows the TPM model related to EK-C.
	    </li>
	    <li>verifies that this EK-C was not used in a (successful) Join before</li>
	    <li>Verifies that the <code>objectAttributes</code> in <code>TPMT_PUBLIC</code> [<cite><a class="bibref" href="#bib-TPMv2-Part2">TPMv2-Part2</a></cite>]
	      matches the following flags: 
	      <code>fixedTPM</code> = 1; <code>fixedParent</code> = 1; <code>sensitiveDataOrigin</code> = 1; 
	      <code>encryptedDuplication</code> = 0; 
	      <code>restricted</code> = 1; <code>decrypt</code> = 0; <code>sign</code> = 1.
	    </li>
	    <li>examines the public key Q, i.e. it verifies that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">Q</span><span class="MJXp-mo" id="MJXp-Span-1834" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1837" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-122">Q \in G_1</script></li>
	    <li>checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">H</span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1844"><span class="MJXp-msubsup" id="MJXp-Span-1845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1847" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1843">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1851" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1852">−</span><span class="MJXp-msubsup" id="MJXp-Span-1853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1855" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1856"><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1860" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1861"><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">Q</span><span class="MJXp-mrow" id="MJXp-Span-1864"><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">n</span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1868"><span class="MJXp-munderover" id="MJXp-Span-1869"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1872" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1873">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-1870"><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1876" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-123">H(P_1^{s_1} \cdot Q^{-c_1} | P_1 | Q | n) \stackrel{?}{=} c_1</script></li>
	    <li>generates the ECDAA credential <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1877"><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">A</span><span class="MJXp-mo" id="MJXp-Span-1880" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881">B</span><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883">C</span><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">D</span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-124">(A, B, C, D)</script> as follows
	      <ol>
    		<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1887"><span class="MJXp-msubsup" id="MJXp-Span-1888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1890" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">D</span><span class="MJXp-mo" id="MJXp-Span-1896" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">p</span><span class="MJXp-mo" id="MJXp-Span-1898" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-125">l_J = RAND(p)</script></li>
    		<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900">A</span><span class="MJXp-mo" id="MJXp-Span-1901" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1905"><span class="MJXp-msubsup" id="MJXp-Span-1906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1908" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1904">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-126">A = P_1^{l_J}</script></li>
    		<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">B</span><span class="MJXp-mo" id="MJXp-Span-1911" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1914" style="vertical-align: 0.5em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-127">B = A^y</script></li>
    		<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">C</span><span class="MJXp-mo" id="MJXp-Span-1917" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1920" style="vertical-align: 0.5em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1921" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1924" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">y</span><span class="MJXp-msubsup" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1929" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-128">C = A^x \cdot Q^{x y l_J}</script></li>
    		<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">D</span><span class="MJXp-mo" id="MJXp-Span-1932" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1935" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1938" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">y</span></span></span></span></span><script type="math/tex" id="MathJax-Element-129">D = Q^{l_J y}</script></li>
	      </ol>
	    </li>
	    <li> proves that it computed this credential correctly:
	      <ol>
		<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1940"><span class="MJXp-msubsup" id="MJXp-Span-1941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1943" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">D</span><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">p</span><span class="MJXp-mo" id="MJXp-Span-1951" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-130">r_2 = RAND(p)</script></li>
		<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1952"><span class="MJXp-msubsup" id="MJXp-Span-1953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1955" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1956" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1960"><span class="MJXp-msubsup" id="MJXp-Span-1961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1963" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1959">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-131">U_2 = P_1^{r_2}</script></li>
		<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1964"><span class="MJXp-msubsup" id="MJXp-Span-1965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1967" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1968" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1971" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1974" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-132">V_2 = Q^{r_2}</script></li>
		<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1975"><span class="MJXp-msubsup" id="MJXp-Span-1976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1978" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">H</span><span class="MJXp-mo" id="MJXp-Span-1981" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983" style="margin-right: 0.05em;">U</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1984" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1985"><span class="MJXp-mo" id="MJXp-Span-1986" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1989" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1990"><span class="MJXp-mo" id="MJXp-Span-1991" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1994" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1995"><span class="MJXp-mo" id="MJXp-Span-1996" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">B</span><span class="MJXp-mrow" id="MJXp-Span-1998"><span class="MJXp-mo" id="MJXp-Span-1999" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">Q</span><span class="MJXp-mrow" id="MJXp-Span-2001"><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">D</span><span class="MJXp-mo" id="MJXp-Span-2004" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-133">c_2 = H(U_2 | V_2 | P_1 | B | Q | D)</script></li>
		<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2005"><span class="MJXp-msubsup" id="MJXp-Span-2006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2008" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2009" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2012" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2013" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2016" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2017" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2020" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">y</span></span></span><script type="math/tex" id="MathJax-Element-134">s_2 = r_2 + c_2 \cdot l_J \cdot y</script></li>
	      </ol>
	    </li>
	    <li>generates a <em>secret</em> (derived from a <em>seed</em>) and wraps the credential <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">A</span><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">B</span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">C</span><span class="MJXp-mo" id="MJXp-Span-2029" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">D</span></span></span><script type="math/tex" id="MathJax-Element-135">A, B, C, D</script> 
	      using that <em>secret</em>.
	    </li>
	    <li>encrypts the <em>seed</em> using the public key included in EK-C.</li>
	    <li>uses <em>seed</em> and <em>name</em> in KDFa (see [<cite><a class="bibref" href="#bib-TPMv2-Part2">TPMv2-Part2</a></cite>] section 24.4) 
	      to derive HMAC and <em>symmetric encryption key</em>. Wrap the <em>secret</em> 
	      in <em>symmetric encryption key</em> and protect it with the <em>HMAC key</em>.
	      <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_11"><span>Note</span></div><p class="">The parameter <em>name</em> in KDFa is derived from 
		<code>TPMT_PUBLIC</code>, see [<cite><a class="bibref" href="#bib-TPMv2-Part1">TPMv2-Part1</a></cite>], section 16.
	      </p></div>
	    </li>
	    <li>sends the credential proof <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2031"><span class="MJXp-msubsup" id="MJXp-Span-2032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2034" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2035" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2038" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-136">c_2, s_2</script> and the wrapped object 
	      including the credential from previous step to the <a href="#dfn-asm" class="internalDFN">ASM</a>.
	    </li>
	  </ol>
	</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> instructs the TPM (by calling TPM2_ActivateCredential) to
	  <ol>
	    <li>decrypt the <em>seed</em> using the TPM Endorsement key</li>
	    <li>compute the <em>name</em> (for the ECDAA attestation key)</li>
	    <li>use the <em>seed</em> in KDFa (with <em>name</em>) to derive the <em>HMAC key</em> 
	      and the <em>symmetric encryption key</em>.</li>
	    <li>use the <em>symmetric encryption key</em> to unwrap the <em>secret</em>.</li>
	  </ol>
	</li>	 
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> 
	  <ol>
	    <li>unwraps the credential <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">A</span><span class="MJXp-mo" id="MJXp-Span-2041" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">B</span><span class="MJXp-mo" id="MJXp-Span-2043" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044">C</span><span class="MJXp-mo" id="MJXp-Span-2045" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">D</span></span></span><script type="math/tex" id="MathJax-Element-137">A, B, C, D</script> using the <em>secret</em> received from the TPM.</li>
	    <li>checks that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048">A</span><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050">B</span><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">C</span><span class="MJXp-mo" id="MJXp-Span-2053" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">D</span><span class="MJXp-mo" id="MJXp-Span-2055" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-2056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2058" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-138">A, B, C, D \in G_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">A</span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-2062"><span class="MJXp-mn" id="MJXp-Span-2063" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2064" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2067" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-139">A \neq 1_{G_1}</script></li>
	    <li>checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">H</span><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-2074"><span class="MJXp-msubsup" id="MJXp-Span-2075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2077" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2073">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2081" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2082">−</span><span class="MJXp-msubsup" id="MJXp-Span-2083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2085" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2086"><span class="MJXp-mo" id="MJXp-Span-2087" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2090" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2093" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2097" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2098">−</span><span class="MJXp-msubsup" id="MJXp-Span-2099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2101" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2102"><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2106" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2107"><span class="MJXp-mo" id="MJXp-Span-2108" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">B</span><span class="MJXp-mrow" id="MJXp-Span-2110"><span class="MJXp-mo" id="MJXp-Span-2111" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">Q</span><span class="MJXp-mrow" id="MJXp-Span-2113"><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">D</span><span class="MJXp-mo" id="MJXp-Span-2116" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-2117"><span class="MJXp-munderover" id="MJXp-Span-2118"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2121" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2122">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2119"><span class="MJXp-mo" id="MJXp-Span-2120" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2125" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-140">H(P_1^{s_2} \cdot B^{-c_2} | Q^{s_2} \cdot D^{-c_2} | P_1 | B | Q | D) \stackrel{?}{=} c_2</script> </li>
	    <li>checks <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">e</span><span class="MJXp-mo" id="MJXp-Span-2128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">A</span><span class="MJXp-mo" id="MJXp-Span-2130" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">Y</span><span class="MJXp-mo" id="MJXp-Span-2132" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-2133"><span class="MJXp-munderover" id="MJXp-Span-2134"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2137" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2138">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2135"><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">e</span><span class="MJXp-mo" id="MJXp-Span-2140" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">B</span><span class="MJXp-mo" id="MJXp-Span-2142" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2145" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2146" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-141">e(A, Y) \stackrel{?}{=} e(B, P_2)</script> and 
	      <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">e</span><span class="MJXp-mo" id="MJXp-Span-2149" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">C</span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2154" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-2156"><span class="MJXp-munderover" id="MJXp-Span-2157"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2160" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2161">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2158"><span class="MJXp-mo" id="MJXp-Span-2159" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">e</span><span class="MJXp-mo" id="MJXp-Span-2163" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">A</span><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">D</span><span class="MJXp-mo" id="MJXp-Span-2167" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">X</span><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-142">e(C, P_2) \stackrel{?}{=} e(A \cdot D, X)</script></li>
	    <li>stores <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">A</span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">B</span><span class="MJXp-mo" id="MJXp-Span-2174" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175">C</span><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177">D</span></span></span><script type="math/tex" id="MathJax-Element-143">A, B, C, D</script> </li>
	  </ol>
	</li>
      </ol>

    </section>  
  </section>

  <section id="ecdaa-sign">
    <h3 aria-level="2" role="heading" id="h3_ecdaa-sign"><span class="secno">3.5 </span>ECDAA-Sign</h3>
    
    <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_12"><span>Note</span></div><div class="">
      <p>One ECDAA-Sign operation is required for the client-side environment whenever a new 
	credential is being registered at a relying party.</p>
    </div></div>
    
    <section class="normativeDisclaimer" id="ecdaa-sign-algorithm">
      <h4 aria-level="3" role="heading" id="h4_ecdaa-sign-algorithm"><span class="secno">3.5.1 </span>ECDAA-Sign Algorithm</h4><p><em>This section is normative.</em></p>
      
      <b>(signature, <a href="#dfn-krd" class="internalDFN">KRD</a>) = EcdaaSign(String <a href="#dfn-appid" class="internalDFN">AppID</a>)</b>
      <p><em>Parameters</em></p>
      <ul>
	<li>p: System parameter prime order of group G1 (global constant)</li>
	<li><a href="#dfn-appid" class="internalDFN">AppID</a>: FIDO <a href="#dfn-appid" class="internalDFN">AppID</a> (i.e. https-URL of TrustedFacets object)</li>
      </ul>
      <p><em>Algorithm outline</em></p>
      <ol>
	<li><a href="#dfn-krd" class="internalDFN">KRD</a> = BuildAndEncodeKRD(); // all traditional Registration tasks are here</li>
	<li>BigNumber <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">l</span><span class="MJXp-mo" id="MJXp-Span-2180" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">D</span><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">p</span><span class="MJXp-mo" id="MJXp-Span-2187" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-144">l = RAND(p)</script></li>
	<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">R</span><span class="MJXp-mo" id="MJXp-Span-2190" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2192" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2193" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-145">R = A^l</script>;</li>
	<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">S</span><span class="MJXp-mo" id="MJXp-Span-2196" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2199" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-146">S = B^l</script>;</li>
	<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201">T</span><span class="MJXp-mo" id="MJXp-Span-2202" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2205" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-147">T = C^l</script>;</li>
	<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207">W</span><span class="MJXp-mo" id="MJXp-Span-2208" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2211" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-148">W = D^l</script>;</li>
	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213">r</span><span class="MJXp-mo" id="MJXp-Span-2214" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218">D</span><span class="MJXp-mo" id="MJXp-Span-2219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">p</span><span class="MJXp-mo" id="MJXp-Span-2221" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-149">r = RAND(p)</script></li>
	<li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">U</span><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2227" style="vertical-align: 0.5em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-150">U = S^r</script></li>
	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">c</span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">H</span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">U</span><span class="MJXp-mrow" id="MJXp-Span-2234"><span class="MJXp-mo" id="MJXp-Span-2235" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">S</span><span class="MJXp-mrow" id="MJXp-Span-2237"><span class="MJXp-mo" id="MJXp-Span-2238" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">W</span><span class="MJXp-mrow" id="MJXp-Span-2240"><span class="MJXp-mo" id="MJXp-Span-2241" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">D</span><span class="MJXp-mrow" id="MJXp-Span-2247"><span class="MJXp-mo" id="MJXp-Span-2248" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">H</span><span class="MJXp-mo" id="MJXp-Span-2250" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">D</span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2255" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-151">c = H(U | S | W | AppID | H(KRD))</script>
	</li>
	<li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">s</span><span class="MJXp-mo" id="MJXp-Span-2258" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">r</span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">c</span><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">k</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2265"><span class="MJXp-mspace" id="MJXp-Span-2266" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-2267" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-2268">mod</span><span class="MJXp-mspace" id="MJXp-Span-2269" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">p</span><span class="MJXp-mo" id="MJXp-Span-2271" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-152">s = r + c \cdot sk \pmod{p}</script></li>
	<li>signature = (c, s, R, S, T, W)</li>
	<li>return (signature, <a href="#dfn-krd" class="internalDFN">KRD</a>) </li>
      </ol>
    </section>
    
    <section class="informative" id="ecdaa-sign-split-between-authenticator-and-asm">
      <h4 aria-level="3" role="heading" id="h4_ecdaa-sign-split-between-authenticator-and-asm"><span class="secno">3.5.2 </span>ECDAA-Sign Split between Authenticator and ASM</h4><p><em>This section is non-normative.</em></p>
      <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_13"><span>Note</span></div><div class="">
	<p>This split requires both the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> and <a href="#dfn-asm" class="internalDFN">ASM</a> to be honest to achieve anonymity. 
	  Only the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> must be trusted for unforgeability. 
	  The communication between <a href="#dfn-asm" class="internalDFN">ASM</a> and <a href="#dfn-authenticator" class="internalDFN">authenticator</a> must be secure.
	</p>
      </div></div>
      <p><em>Algorithm outline</em></p>
      <ol>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> randomizes the credential
	  <ol>
	    <li>BigNumber <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">l</span><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">D</span><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">p</span><span class="MJXp-mo" id="MJXp-Span-2281" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-153">l = RAND(p)</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">R</span><span class="MJXp-mo" id="MJXp-Span-2284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2287" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-154">R = A^l</script>;</li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">S</span><span class="MJXp-mo" id="MJXp-Span-2290" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2292" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2293" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-155">S = B^l</script>;</li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295">T</span><span class="MJXp-mo" id="MJXp-Span-2296" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2299" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-156">T = C^l</script>;</li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">W</span><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2305" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-157">W = D^l</script>;</li>
	  </ol>
	</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> sends <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">l</span><span class="MJXp-mo" id="MJXp-Span-2308" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2309">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313">D</span></span></span><script type="math/tex" id="MathJax-Element-158">l, AppID</script> to the <a href="#dfn-authenticator" class="internalDFN">authenticator</a></li>
	<li> The <a href="#dfn-authenticator" class="internalDFN">authenticator</a> performs the following tasks
	  <ol>
	    <li><a href="#dfn-krd" class="internalDFN">KRD</a> = BuildAndEncodeKRD(); // all traditional Registration tasks are here</li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2314"><span class="MJXp-msup" id="MJXp-Span-2315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316" style="margin-right: 0.05em;">S</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2317" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2318" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2321" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-159">S' = B^l</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2322"><span class="MJXp-msup" id="MJXp-Span-2323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2325" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2328" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2329" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-160">W' = D^l</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331">r</span><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2335">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">D</span><span class="MJXp-mo" id="MJXp-Span-2337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">p</span><span class="MJXp-mo" id="MJXp-Span-2339" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-161">r = RAND(p)</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">U</span><span class="MJXp-mo" id="MJXp-Span-2342" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2345" style="vertical-align: 0.5em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-162">U = S^r</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">c</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">H</span><span class="MJXp-mo" id="MJXp-Span-2350" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">U</span><span class="MJXp-mrow" id="MJXp-Span-2352"><span class="MJXp-mo" id="MJXp-Span-2353" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msup" id="MJXp-Span-2354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2355" style="margin-right: 0.05em;">S</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2356" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-2357"><span class="MJXp-mo" id="MJXp-Span-2358" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msup" id="MJXp-Span-2359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2361" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-2362"><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2368">D</span><span class="MJXp-mrow" id="MJXp-Span-2369"><span class="MJXp-mo" id="MJXp-Span-2370" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">H</span><span class="MJXp-mo" id="MJXp-Span-2372" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">D</span><span class="MJXp-mo" id="MJXp-Span-2376" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2377" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-163">c = H(U | S' | W' | AppID | H(KRD))</script></li>
	    <li>BigInteger <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">s</span><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">r</span><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">c</span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">k</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2387"><span class="MJXp-mspace" id="MJXp-Span-2388" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-2389" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-2390">mod</span><span class="MJXp-mspace" id="MJXp-Span-2391" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">p</span><span class="MJXp-mo" id="MJXp-Span-2393" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-164">s = r + c \cdot sk \pmod{p}</script></li>
	    <li>Send <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395">c</span><span class="MJXp-mo" id="MJXp-Span-2396" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397">s</span><span class="MJXp-mo" id="MJXp-Span-2398" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">D</span></span></span><script type="math/tex" id="MathJax-Element-165">c, s, KRD</script> to the <a href="#dfn-asm" class="internalDFN">ASM</a></li>
	</ol></li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> sets signature = (c, s, R, S, T, W) and outputs (signature, <a href="#dfn-krd" class="internalDFN">KRD</a>)</li>
      </ol>
    </section>
    
    <section class="informative" id="ecdaa-sign-split-between-tpm-and-asm">
      <h4 aria-level="3" role="heading" id="h4_ecdaa-sign-split-between-tpm-and-asm"><span class="secno">3.5.3 </span>ECDAA-Sign Split between TPM and ASM</h4><p><em>This section is non-normative.</em></p>
      <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_14"><span>Note</span></div><div class="">
	<p> This algorithm is for the special case of a TPMv2 as <a href="#dfn-authenticator" class="internalDFN">authenticator</a>.
	  This case requires both the TPM and <a href="#dfn-asm" class="internalDFN">ASM</a> to be honest for anonymity and unforgeability (see [<cite><a class="bibref" href="#bib-XYZF-2014">XYZF-2014</a></cite>]). </p>
      </div></div>
      <p><em>Algorithm outline</em></p>
      <ol>
	<li> The <a href="#dfn-asm" class="internalDFN">ASM</a> randomizes the credential
	  <ol>
	    <li>BigNumber <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">l</span><span class="MJXp-mo" id="MJXp-Span-2404" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2407">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">D</span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">p</span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-166">l = RAND(p)</script></li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">R</span><span class="MJXp-mo" id="MJXp-Span-2414" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2417" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-167">R = A^l</script>;</li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419">S</span><span class="MJXp-mo" id="MJXp-Span-2420" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2423" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-168">S = B^l</script>;</li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">T</span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2429" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-169">T = C^l</script>;</li>
	    <li>ECPoint <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431">W</span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2434" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2435" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-170">W = D^l</script>;</li>
	  </ol>
	</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> calls TPM2_Commit() with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">P</span><span class="MJXp-mn" id="MJXp-Span-2438">1</span></span></span><script type="math/tex" id="MathJax-Element-171">P1</script> set to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440">S</span></span></span><script type="math/tex" id="MathJax-Element-172">S</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">s</span><span class="MJXp-mn" id="MJXp-Span-2443">2</span><span class="MJXp-mo" id="MJXp-Span-2444" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">y</span><span class="MJXp-mn" id="MJXp-Span-2446">2</span></span></span><script type="math/tex" id="MathJax-Element-173">s2, y2</script> empty buffers. 
	  The <a href="#dfn-asm" class="internalDFN">ASM</a> receives the result values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2448">K</span><span class="MJXp-mo" id="MJXp-Span-2449" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2450">L</span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">E</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2456" style="vertical-align: 0.5em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-174">K, L, E=S^r</script> and ctr.  <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">K</span></span></span><script type="math/tex" id="MathJax-Element-175">K</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460">L</span></span></span><script type="math/tex" id="MathJax-Element-176">L</script> are empty since
	  <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">s</span><span class="MJXp-mn" id="MJXp-Span-2463">2</span><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465">y</span><span class="MJXp-mn" id="MJXp-Span-2466">2</span></span></span><script type="math/tex" id="MathJax-Element-177">s2, y2</script> are empty buffers.
	</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> calls TPM2_Create to generate the new authentication key pair.</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> calls TPM2_Certify() on the newly created key with ctr from the TPM2_Commit 
	  and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468">E</span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2470">S</span><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472">W</span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2477">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">D</span></span></span><script type="math/tex" id="MathJax-Element-178">E, S, W, AppID</script> as qualifying data (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">E</span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2484" style="vertical-align: 0.5em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-179">E=S^r</script> is returned by step 2).
	  The <a href="#dfn-asm" class="internalDFN">ASM</a> receives signature <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486">c</span><span class="MJXp-mo" id="MJXp-Span-2487" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">s</span></span></span><script type="math/tex" id="MathJax-Element-180">c, s</script> and attestation block <a href="#dfn-krd" class="internalDFN">KRD</a> (i.e. TPMS_ATTEST structure in this case).
	</li>
	<li>The <a href="#dfn-asm" class="internalDFN">ASM</a> sets signature = (c, s, R, S, T, W) and outputs (signature, <a href="#dfn-krd" class="internalDFN">KRD</a>)</li>
      </ol>
    </section>
  </section>

  <section class="normativeDisclaimer" id="ecdaa-verify-operation">
    <h3 aria-level="2" role="heading" id="h3_ecdaa-verify-operation"><span class="secno">3.6 </span>ECDAA-Verify Operation</h3><p><em>This section is normative.</em></p>
    <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_15"><span>Note</span></div><div class="">
      <p>One ECDAA-Verify operation is required for the FIDO Server as part of each FIDO Registration.</p>
    </div></div>

    <b>boolean EcdaaVerify(signature, <a href="#dfn-appid" class="internalDFN">AppID</a>, <a href="#dfn-krd" class="internalDFN">KRD</a>, ModelName)</b>
    <p><em>Parameters</em></p>
    <ul>
      <li>p: System parameter prime order of group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2489"><span class="MJXp-msubsup" id="MJXp-Span-2490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2492" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-181">G_1</script> (global constant)</li>
      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2493"><span class="MJXp-msubsup" id="MJXp-Span-2494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2496" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-182">P_2</script>: System parameter generator of group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2497"><span class="MJXp-msubsup" id="MJXp-Span-2498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2500" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-183">G_2</script> (global constant)</li>
      <li>signature: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2501"><span class="MJXp-mo" id="MJXp-Span-2502" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503">c</span><span class="MJXp-mo" id="MJXp-Span-2504" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">s</span><span class="MJXp-mo" id="MJXp-Span-2506" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">R</span><span class="MJXp-mo" id="MJXp-Span-2508" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509">S</span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511">T</span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2513">W</span><span class="MJXp-mo" id="MJXp-Span-2514" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-184">(c, s, R, S, T, W)</script></li>
      <li><a href="#dfn-appid" class="internalDFN">AppID</a>: FIDO <a href="#dfn-appid" class="internalDFN">AppID</a></li>
      <li><a href="#dfn-krd" class="internalDFN">KRD</a>: Attestation Data object as defined in other specifications.</li>
      <li>ModelName: the claimed FIDO <a href="#dfn-authenticator" class="internalDFN">authenticator</a> model (i.e. either AAID or AAGUID)</li>
    </ul>
    <p><em>Algorithm outline</em></p>
    <ol>
      <li>Based on the claimed ModelName, look up <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2516">X</span><span class="MJXp-mo" id="MJXp-Span-2517" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518">Y</span></span></span><script type="math/tex" id="MathJax-Element-185">X, Y</script> from trusted source </li>
      <li>Check that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">R</span><span class="MJXp-mo" id="MJXp-Span-2521" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522">S</span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524">T</span><span class="MJXp-mo" id="MJXp-Span-2525" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526">W</span><span class="MJXp-mo" id="MJXp-Span-2527" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-2528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2530" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-186">R, S, T, W \in G_1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532">R</span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-2534"><span class="MJXp-mn" id="MJXp-Span-2535" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2536" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2538" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2539" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-187">R \neq 1_{G_1}</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2541">S</span><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-2543"><span class="MJXp-mn" id="MJXp-Span-2544" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2545" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2548" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-188">S \neq 1_{G_1}</script>.</li>
      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2550">H</span><span class="MJXp-mo" id="MJXp-Span-2551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2554" style="vertical-align: 0.5em;">s</span></span><span class="MJXp-mo" id="MJXp-Span-2555" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2557" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2558" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2559">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560">c</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2561"><span class="MJXp-mo" id="MJXp-Span-2562" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">S</span><span class="MJXp-mrow" id="MJXp-Span-2564"><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566">W</span><span class="MJXp-mrow" id="MJXp-Span-2567"><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2571">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2573">D</span><span class="MJXp-mrow" id="MJXp-Span-2574"><span class="MJXp-mo" id="MJXp-Span-2575" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2576">H</span><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">D</span><span class="MJXp-mo" id="MJXp-Span-2581" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2582" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-2583"><span class="MJXp-munderover" id="MJXp-Span-2584"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2587" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2588">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2585"><span class="MJXp-mo" id="MJXp-Span-2586" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2589">c</span></span></span><script type="math/tex" id="MathJax-Element-189">H(S^s \cdot W^{-c} | S | W | AppID | H(KRD)) \stackrel{?}{=} c</script>; fail if not equal
	<div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_16"><span>Note</span></div><div class="review">
	  <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2591">B</span><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2595" style="vertical-align: 0.5em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-2596" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2602">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2599">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-190">B = A^y = P_1^{l y}</script></p>
	  <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604">D</span><span class="MJXp-mo" id="MJXp-Span-2605" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2607" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2608" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2610" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2611" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612">y</span></span></span><span class="MJXp-mo" id="MJXp-Span-2613" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-2617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619">k</span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2622" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2616">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2624" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2626" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2627" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2628">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2629">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-191">D = Q^{l_J y} = P_1^{sk l_J y} = B^{sk}</script></p>
	  <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631">S</span><span class="MJXp-mo" id="MJXp-Span-2632" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2634" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2635" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-192">S = B^l</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">W</span><span class="MJXp-mo" id="MJXp-Span-2638" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2640" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2641" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-193">W = D^l</script></p>
	  <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643">U</span><span class="MJXp-mo" id="MJXp-Span-2644" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2647" style="vertical-align: 0.5em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-194">U = S^r</script></p>
	  <p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2648"><span class="MJXp-msubsup" id="MJXp-Span-2649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2651" style="vertical-align: 0.5em;">s</span></span><span class="MJXp-mo" id="MJXp-Span-2652" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2654" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2655" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2656">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-2658" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2661" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2662">r</span><span class="MJXp-mo" id="MJXp-Span-2663">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2664">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2666">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2667" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2670" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2671">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2672">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2674">U</span><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2678" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2679">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2680">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2681">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2682" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2684" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2685" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2686">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687">c</span></span></span></span></span><script type="math/tex" id="MathJax-Element-195">S^s \cdot W^{-c} = S^{r + c sk} \cdot W^{-c} = U \cdot S^{c sk} \cdot W^{-c}</script><br>
	      <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2688"><span class="MJXp-mo" id="MJXp-Span-2689" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2690">U</span><span class="MJXp-mo" id="MJXp-Span-2691" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2694" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2697">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2699" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2702" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2703">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-2706" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707">U</span><span class="MJXp-mo" id="MJXp-Span-2708" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2710" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2711" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2712">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2713">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2714">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2715">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2719" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2720">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2721">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2722">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2723">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2725" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726">U</span></span></span><script type="math/tex" id="MathJax-Element-196"> = U \cdot B^{l c sk} \cdot D^{-l c} = U \cdot B^{l c sk} \cdot B^{-l c sk} = U</script>
	    </p>
	</div></div>
      </li>
      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728">e</span><span class="MJXp-mo" id="MJXp-Span-2729" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730">R</span><span class="MJXp-mo" id="MJXp-Span-2731" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2732">Y</span><span class="MJXp-mo" id="MJXp-Span-2733" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-2734"><span class="MJXp-munderover" id="MJXp-Span-2735"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2738" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2739">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2736"><span class="MJXp-mo" id="MJXp-Span-2737" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740">e</span><span class="MJXp-mo" id="MJXp-Span-2741" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742">S</span><span class="MJXp-mo" id="MJXp-Span-2743" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2746" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2747" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-197">e(R, Y) \stackrel{?}{=} e(S, P_2)</script>; fail if not equal 
	<div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_17"><span>Note</span></div><p class="review"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2749">e</span><span class="MJXp-mo" id="MJXp-Span-2750" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2751">R</span><span class="MJXp-mo" id="MJXp-Span-2752" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753">Y</span><span class="MJXp-mo" id="MJXp-Span-2754" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2756">e</span><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2759" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2760" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2761" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2763" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765">y</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2764">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2766" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2767" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768">e</span><span class="MJXp-mo" id="MJXp-Span-2769" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2770">S</span><span class="MJXp-mo" id="MJXp-Span-2771" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2773" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2774" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2775" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2776" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2777">e</span><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2781" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2782" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2784" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2785" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2786" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2787" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2788">e</span><span class="MJXp-mo" id="MJXp-Span-2789" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2792" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2793">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794">y</span></span></span><span class="MJXp-mo" id="MJXp-Span-2795" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2798" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2799" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-198">e(R, Y) = e(A^l, P_2^y); e(S, P_2) = e(B^l, P_2) = e(A^{l y}, P_2)</script></p></div>
      </li>
      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2801">e</span><span class="MJXp-mo" id="MJXp-Span-2802" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2803">T</span><span class="MJXp-mo" id="MJXp-Span-2804" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2807" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2808" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-2809"><span class="MJXp-munderover" id="MJXp-Span-2810"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2813" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2814">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2811"><span class="MJXp-mo" id="MJXp-Span-2812" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2815">e</span><span class="MJXp-mo" id="MJXp-Span-2816" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2817">R</span><span class="MJXp-mo" id="MJXp-Span-2818" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819">W</span><span class="MJXp-mo" id="MJXp-Span-2820" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821">X</span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-199">e(T, P_2) \stackrel{?}{=} e(R \cdot W, X)</script>; fail if not equal
	<div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_18"><span>Note</span></div><p class="review"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2824">e</span><span class="MJXp-mo" id="MJXp-Span-2825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2826">T</span><span class="MJXp-mo" id="MJXp-Span-2827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2830" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2831" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2832" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2833">e</span><span class="MJXp-mo" id="MJXp-Span-2834" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2836" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2837" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2838" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2841" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2842" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2843" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2844">e</span><span class="MJXp-mo" id="MJXp-Span-2845" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2848" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2849">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850">l</span></span></span><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2854" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2855">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2856">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857">y</span><span class="MJXp-msubsup" id="MJXp-Span-2858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2860" style="vertical-align: -0.4em;">J</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2861" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2863" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2864" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2865" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2866" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2867">e</span><span class="MJXp-mo" id="MJXp-Span-2868" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2871" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2872" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2874" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2875" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2876" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2877">X</span><span class="MJXp-mo" id="MJXp-Span-2878" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2879" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2880">e</span><span class="MJXp-mo" id="MJXp-Span-2881" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2883" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2884" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2885" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2887" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2888" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2889">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2890">y</span><span class="MJXp-msubsup" id="MJXp-Span-2891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2892" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2893" style="vertical-align: -0.4em;">J</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2896" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2898">x</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2897">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2899" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-200">e(T, P_2) = e(C^l, P_2) = e(A^{x l} \cdot Q^{x l y l_J}, P_2); 
	  e(A^l \cdot D^l, X) = e(A^l \cdot Q^{l y l_J}, P_2^x)</script></p></div>
      </li>
      <li>for (all sk' on RogueList) do if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901">W</span><span class="MJXp-mrow" id="MJXp-Span-2902"><span class="MJXp-munderover" id="MJXp-Span-2903"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2906" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2907">?</span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2904"><span class="MJXp-mo" id="MJXp-Span-2905" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2909" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2910" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2911">s</span><span class="MJXp-msup" id="MJXp-Span-2912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2913" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2914" style="vertical-align: 0.5em;">′</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-201">W \stackrel{?}{=} S^{sk'}</script> fail;
      </li><li>// perform all other processing steps for new credential registration
	<div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_19"><span>Note</span></div><div class="">
	  In the case of a TPMv2, i.e. <a href="#dfn-krd" class="internalDFN">KRD</a> is a <code>TPMS_ATTEST</code> object. In this case the 
	  verifier must check whether the <code>TPMS_ATTEST</code> object starts 
	  with <code>TPM_GENERATED</code> magic number and whether its field 
	  <code>objectAttributes</code> contains the flag <code>fixedTPM</code>=1 
	  (indicating that the key was generated by the TPM).
	</div></div>
      </li>
      <li>return true;</li>
    </ol>
    
  </section>

</section>

<section class="normativeDisclaimer" id="fido-ecdaa-object-formats-and-algorithm-details">
  <!--OddPage--><h2 aria-level="1" role="heading" id="h2_fido-ecdaa-object-formats-and-algorithm-details"><span class="secno">4. </span>FIDO ECDAA Object Formats and Algorithm Details</h2><p><em>This section is normative.</em></p>

  <section id="supported-curves-for-ecdaa">
    <h3 aria-level="2" role="heading" id="h3_supported-curves-for-ecdaa"><span class="secno">4.1 </span>Supported Curves for ECDAA</h3>	

<!-- see [ISO/IEC 15946-5 : 2008 Clause 7.3 “BN curve”], which is 
     equivalent to [IEEE P1363.3 (Draft 2) Clause A.11.5 BN Curves]. 
-->
    <p><b>Definition of G1</b></p>
    G1 is an elliptic curve group E : <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2915"><span class="MJXp-msubsup" id="MJXp-Span-2916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2917" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2918" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2919" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2922" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-2923" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925">x</span><span class="MJXp-mo" id="MJXp-Span-2926" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2927">b</span></span></span><script type="math/tex" id="MathJax-Element-202">y^2 = x^3 + ax + b</script>
    over <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2929">F</span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931">q</span><span class="MJXp-mo" id="MJXp-Span-2932" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-203">F(q)</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934">a</span><span class="MJXp-mo" id="MJXp-Span-2935" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2936">0</span></span></span><script type="math/tex" id="MathJax-Element-204">a=0</script>.  

    <p><b>Definition of G2</b></p>
    G2 is the p-torsion subgroup of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2937"><span class="MJXp-msup" id="MJXp-Span-2938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2939" style="margin-right: 0.05em;">E</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2940" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2944" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2947" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2948" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-205">E'(F_{q^2})</script> where E' is a sextic twist of E.  
    With E' : <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2949"><span class="MJXp-msubsup" id="MJXp-Span-2950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2951" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2952" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2953">′</span><span class="MJXp-mn" id="MJXp-Span-2954">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2955" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2957" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2958" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2959">′</span><span class="MJXp-mn" id="MJXp-Span-2960">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-2961" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msup" id="MJXp-Span-2962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2964" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-206">y'^2 = x'^3 + b'</script>.

    <p>An element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2966">F</span><span class="MJXp-mo" id="MJXp-Span-2967" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2970" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2971" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-207">F(q^2)</script> is represented by a pair (a,b) where a + bX is an element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973">F</span><span class="MJXp-mo" id="MJXp-Span-2974" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975">q</span><span class="MJXp-mo" id="MJXp-Span-2976" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2977" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2978">X</span><span class="MJXp-mo" id="MJXp-Span-2979" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mrow" id="MJXp-Span-2980"><span class="MJXp-mo" id="MJXp-Span-2981" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-2982" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2985" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2986" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2987">1</span><span class="MJXp-mo" id="MJXp-Span-2988" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-208">F(q)[X] / <X^2+1></script>.  
	We use angle brackets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2989"><span class="MJXp-mo" id="MJXp-Span-2990" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2991">Y</span><span class="MJXp-mo" id="MJXp-Span-2992" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-209"><Y></script> to signify the ideal generated by the enclosed value.</p>
    <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_20"><span>Note</span></div><p class="">In the literature the pair (a,b) is sometimes also written as a complex number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994">a</span><span class="MJXp-mo" id="MJXp-Span-2995" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2996">b</span><span class="MJXp-mo" id="MJXp-Span-2997" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2998">i</span></span></span><script type="math/tex" id="MathJax-Element-210">a+b*i</script>.
    </p></div>

    <p><b>Definition of GT</b></p>
    GT is an order-p subgroup of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2999"><span class="MJXp-msubsup" id="MJXp-Span-3000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3001" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3002" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3004" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3005" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-3006">12</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-211">F_{q^{12}}</script>.

    <p><b>Pairings</b></p>
    We propose the use of Ate pairings as they are efficient (more efficient than Tate pairings) 
    on Barreto-Naehrig curves [<cite><a class="bibref" href="#bib-DevScoDah2007">DevScoDah2007</a></cite>].

    <p><b>Supported BN curves</b></p>

    <div>
      <p>We use pairing-friendly Barreto-Naehrig [<cite><a class="bibref" href="#bib-BarNae-2006">BarNae-2006</a></cite>] [<cite><a class="bibref" href="#bib-ISO15946-5">ISO15946-5</a></cite>] elliptic curves. 
	The curves <code>TPM_ECC_BN_P256</code> and 
	<code>TPM_ECC_BN_P638</code> curves are defined in [<cite><a class="bibref" href="#bib-TPMv2-Part4">TPMv2-Part4</a></cite>].
      </p>
      <p>BN curves have a Modulus <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3008">q</span><span class="MJXp-mo" id="MJXp-Span-3009" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3010">36</span><span class="MJXp-mo" id="MJXp-Span-3011" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3013" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3014" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-3015" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3016">36</span><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3019" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3020" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-3021" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3022">24</span><span class="MJXp-mo" id="MJXp-Span-3023" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3025" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3026" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3027" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3028">6</span><span class="MJXp-mo" id="MJXp-Span-3029" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030">u</span><span class="MJXp-mo" id="MJXp-Span-3031" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3032">1</span></span></span><script type="math/tex" id="MathJax-Element-212">q = 36 \cdot u^4 + 36 \cdot u^3 + 24 \cdot u^2 + 6 \cdot u + 1</script> [<cite><a class="bibref" href="#bib-ISO15946-5">ISO15946-5</a></cite>] and
	 a related order of the group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3034">p</span><span class="MJXp-mo" id="MJXp-Span-3035" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3036">36</span><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3040" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-3041" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3042">36</span><span class="MJXp-mo" id="MJXp-Span-3043" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3045" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3046" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-3047" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3048">18</span><span class="MJXp-mo" id="MJXp-Span-3049" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3051" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3052" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3053" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3054">6</span><span class="MJXp-mo" id="MJXp-Span-3055" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3056">u</span><span class="MJXp-mo" id="MJXp-Span-3057" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3058">1</span></span></span><script type="math/tex" id="MathJax-Element-213">p = 36 \cdot u^4 + 36 \cdot u^3 + 18 \cdot u^2 + 6 \cdot u + 1</script> [<cite><a class="bibref" href="#bib-ISO15946-5">ISO15946-5</a></cite>].
      </p>

      <ul>
	<li><code>TPM_ECC_BN_P256</code> is a curve of form E(F(q)), where q is the field modulus 
	  [<cite><a class="bibref" href="#bib-TPMv2-Part4">TPMv2-Part4</a></cite>] [<cite><a class="bibref" href="#bib-BarNae-2006">BarNae-2006</a></cite>].  This curve is identical to the P256 curve defined in [<cite><a class="bibref" href="#bib-ISO15946-5">ISO15946-5</a></cite>] section C.3.5.
	  <ul>
	    <li>The values have been generated using u=-7 530 851 732 716 300 289.</li>
	    <li>Modulus q = 115 792 089 237 314 936 872 688 561 244 471 742 058 375 878 355 761 205 198 700 409 522 629 664 518 163</li>
	    <li>Group order p = 115 792 089 237 314 936 872 688 561 244 471 742 058 035 595 988 840 268 584 488 757 999 429 535 617 037</li>
	    <li>p and q have length of 256 bit each.</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3060">b</span></span></span><script type="math/tex" id="MathJax-Element-214">b</script> = 3</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3061"><span class="MJXp-msubsup" id="MJXp-Span-3062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3063" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3064" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-215">P_1</script>_256 = (x=1, y=2)</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3065"><span class="MJXp-msup" id="MJXp-Span-3066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3068" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-216">b'</script> = (a=3, b=3)</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3069"><span class="MJXp-msubsup" id="MJXp-Span-3070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3071" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3072" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-217">P_2</script>_256 = (x,y), with
	      <ul>
		<li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3073"><span class="MJXp-msubsup" id="MJXp-Span-3074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3075" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3076" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-218">P_2</script>_256.x = (a=114 909 019 869 825 495 805 094 438 766 505 779 201 460 871 441 403 689 227 802 685 522 624 680 861 435, b=35 574 363 727 580 634 541 930 638 464 681 913 209 705 880 605 623 913 174 726 536 241 706 071 648 811)
		</li>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3077"><span class="MJXp-msubsup" id="MJXp-Span-3078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3079" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3080" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-219">P_2</script>_256.y = (a=65 076 021 719 150 302 283 757 931 701 622 350 436 355 986 716 727 896 397 520 706 509 932 529 649 684, b=113 380 538 053 789 372 416 298 017 450 764 517 685 681 349 483 061 506 360 354 665 554 452 649 749 368)
		  </li>
		</ul>
	    </li>
	  </ul>
	</li>
	<li><code>TPM_ECC_BN_P638</code> [<cite><a class="bibref" href="#bib-TPMv2-Part4">TPMv2-Part4</a></cite>] uses 
	  <ul>
	    <li>The values have been generated using u=365 375 408 992 443 362 629 982 744 420 548 242 302 862 098 433</li>
	    <li>Modulus q = 641 593 209 463 000 238 284 923 228 689 168 801 117 629 789 043 238 356 871 360 716 989 515 584 497 239 494 051 781 991 794 253 619 096 481 315 470 262 367 432 019 698 642 631 650 152 075 067 922 231 951 354 925 301 839 708 740 457 083 469 793 717 125 223</li>
	    <li>The related order of the group is p = 641 593 209 463 000 238 284 923 228 689 168 801 117 629 789 043 238 356 871 360 716 989 515 584 497 239 494 051 781 991 794 252 818 101 344 337 098 690 003 906 272 221 387 599 391 201 666 378 807 960 583 525 233 832 645 565 592 955 122 034 352 630 792 289</li>
	    <li>p and q have length of 638 bit each.</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082">b</span></span></span><script type="math/tex" id="MathJax-Element-220">b</script> = 257</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3083"><span class="MJXp-msubsup" id="MJXp-Span-3084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3085" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3086" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-221">P_1</script>_638 = (x=641 593 209 463 000 238 284 923 228 689 168 801 117 629 789 043 238 356 871 360 716 989 515 584 497 239 494 051 781 991 794 253 619 096 481 315 470 262 367 432 019 698 642 631 650 152 075 067 922 231 951 354 925 301 839 708 740 457 083 469 793 717 125 222, y=16)
	    </li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3087"><span class="MJXp-msup" id="MJXp-Span-3088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3089" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3090" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-222">b'</script> = (a=771, b=1542)</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3091"><span class="MJXp-msubsup" id="MJXp-Span-3092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3093" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3094" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-223">P_2</script>_638 = (x, y), with
	      <ul>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3095"><span class="MJXp-msubsup" id="MJXp-Span-3096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3097" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3098" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-224">P_2</script>_638.x = (a=192 492 098 325 059 629 927 844 609 092 536 807 849 769 208 589 403 233 289 748 474 758 010 838 876 457 636 072 173 883 771 602 089 605 233 264 992 910 618 494 201 909 695 576 234 119 413 319 303 931 909 848 663 554 062 144 113 485 982 076 866 968 711 247, b=166 614 418 891 499 184 781 285 132 766 747 495 170 152 701 259 472 324 679 873 541 478 330 301 406 623 174 002 502 345 930 325 474 988 134 317 071 869 554 535 111 092 924 719 466 650 228 182 095 841 246 668 361 451 788 368 418 036 777 197 454 618 413 255)
		</li>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3099"><span class="MJXp-msubsup" id="MJXp-Span-3100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3101" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3102" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-225">P_2</script>_638.y = (a=622 964 952 935 200 827 531 506 751 874 167 806 262 407 152 244 280 323 674 626 687 789 202 660 794 092 633 841 098 984 322 671 973 226 667 873 503 889 270 602 870 064 426 165 592 237 410 681 318 519 893 784 898 821 343 051 339 820 566 224 981 344 169 470, b=514 285 963 827 225 043 076 463 721 426 569 583 576 029 220 880 138 564 906 219 230 942 887 639 456 599 654 554 743 732 087 558 187 149 207 036 952 474 092 411 405 629 612 957 921 369 286 372 038 525 830 610 755 207 588 843 864 366 759 521 090 861 911 494)
		</li>
	      </ul>
	    </li>
	  </ul>
	</li>
	<li><code>ECC_BN_DSD_P256</code> [<cite><a class="bibref" href="#bib-DevScoDah2007">DevScoDah2007</a></cite>] section 3 uses
	  <ul>
	    <li>The values have been generated using u=6 917 529 027 641 089 837</li>
	    <li>Modulus q = 82434016654300679721217353503190038836571781811386228921167322412819029493183</li>
	    <li>The related order of the 
	      group is p = 82434016654300679721217353503190038836284668564296686430114510052556401373769</li>
	    <li>p and q have length of 256 bit each.</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3104">b</span></span></span><script type="math/tex" id="MathJax-Element-226">b</script> = 3</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3105"><span class="MJXp-msubsup" id="MJXp-Span-3106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3107" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3108" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-227">P_1</script>_DSD_P256 = (1, 2)</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3109"><span class="MJXp-msup" id="MJXp-Span-3110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3111" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3112" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-228">b'</script> = (a=3, b=6)</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3113"><span class="MJXp-msubsup" id="MJXp-Span-3114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3115" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3116" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-229">P_2</script>_DSD_P256 = (x, y), with
	      <ul>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3117"><span class="MJXp-msubsup" id="MJXp-Span-3118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3120" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-230">P_2</script>_DSD_P256.x = (a=73 481 346 555 305 118 071 940 904 527 347 990 526 214 212 698 180 576 973 201 374 397 013 567 073 039,
		  b=28 955 468 426 222 256 383 171 634 927 293 329 392 145 263 879 318 611 908 127 165 887 947 997 417 463)</li>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3121"><span class="MJXp-msubsup" id="MJXp-Span-3122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3123" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3124" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-231">P_2</script>_DSD_P256.y = (a=3 632 491 054 685 712 358 616 318 558 909 408 435 559 591 759 282 597 787 781 393 534 962 445 630 353,
		  b=60 960 585 579 560 783 681 258 978 162 498 088 639 544 584 959 644 221 094 447 372 720 880 177 666 763)</li>
	      </ul>
	    </li>
	  </ul>
	</li>
	<li><code>ECC_BN_ISOP512</code> [<cite><a class="bibref" href="#bib-ISO15946-5">ISO15946-5</a></cite>] section C.3.7 uses
	  <ul>
	    <li>The values have been generated using u=138 919 694 570 470 098 040 331 481 282 401 523 727</li>
	    <li>Modulus q = 13 407 807 929 942 597 099 574 024 998 205 830 437 246 153 344 875 111 580 494 527 427 714 590 099 881 795 845 981 157 516 604 994 291 639 750 834 285 779 043 186 149 750 164 319 950 153 126 044 364 566 323</li>
	    <li>The related order of the group is p = 13 407 807 929 942 597 099 574 024 998 205 830 437 246 153 344 875 111 580 494 527 427 714 590 099 881 680 053 891 920 200 409 570 720 654 742 146 445 677 939 306 408 461 754 626 647 833 262 056 300 743 149 </li>
	    <li>p and q have length of 512 bit each.</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3126">b</span></span></span><script type="math/tex" id="MathJax-Element-232">b</script> = 3</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3127"><span class="MJXp-msubsup" id="MJXp-Span-3128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3130" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-233">P_1</script>_ISO_P512 = (x=1,y=2)</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3131"><span class="MJXp-msup" id="MJXp-Span-3132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3133" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3134" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-234">b'</script> = (a=3, b=3)</li>
	    <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3135"><span class="MJXp-msubsup" id="MJXp-Span-3136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3138" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-235">P_2</script>_ISO_P512 = (x, y), with
	      <ul>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3139"><span class="MJXp-msubsup" id="MJXp-Span-3140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3141" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3142" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-236">P_2</script>_ISO_P512.x = (a=3 094 648 157 539 090 131 026 477 120 117 259 896 222 920 557 994 037 039 545 437 079 729 804 516 315 481 514 566 156 984 245 473 190 248 967 907 724 153 072 490 467 902 779 495 072 074 156 718 085 785 269, b=3 776 690 234 788 102 103 015 760 376 468 067 863 580 475 949 014 286 077 855 600 384 033 870 546 339 773 119 295 555 161 718 985 244 561 452 474 412 673 836 012 873 126 926 524 076 966 265 127 900 471 529)
		</li>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3143"><span class="MJXp-msubsup" id="MJXp-Span-3144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3146" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-237">P_2</script>_ISO_P512.y = (a=7 593 872 605 334 070 150 001 723 245 210 278 735 800 573 263 881 411 015 285 406 372 548 542 328 752 430 917 597 485 450 360 707 892 769 159 214 115 916 255 816 324 924 295 339 525 686 777 569 132 644 242, b=9 131 995 053 349 122 285 871 305 684 665 648 028 094 505 015 281 268 488 257 987 110 193 875 868 585 868 792 041 571 666 587 093 146 239 570 057 934 816 183 220 992 460 187 617 700 670 514 736 173 834 408)
		</li>
	      </ul>
	    </li>
	  </ul>
	</li>
    </ul></div>
    <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_21"><span>Note</span></div><p class="">Spaces are used inside numbers to improve readability.</p></div>

    <p><b>Hash Algorithms</b></p>
    <p>Depending on the curve, we use <code>H(x) = SHA256(x) mod p</code> or 
      <code>H(x) = SHA512(x) mod p</code> as hash algorithm H:<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3147"><span class="MJXp-mo" id="MJXp-Span-3148" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-3149">0</span><span class="MJXp-mo" id="MJXp-Span-3150" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3151">1</span><span class="MJXp-msubsup" id="MJXp-Span-3152"><span class="MJXp-mo" id="MJXp-Span-3153" style="margin-left: 0em; margin-right: 0.05em;">}</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3154" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-3155" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-3156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3157" style="margin-right: 0.05em;">Z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3158" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-238"> \{0, 1\}^* \rightarrow Z_p</script>.
    </p>
    <p>The argument of the hash function must always be converted to a byte string using the appropriate 
      encoding function specific in section <a href="#object-encodings" class="sec-ref"><span class="secno">3.1</span> <span class="sec-title">Object Encodings</span></a>, e.g. according to section
      <a href="#encoding-ecpoint2-values-as-byte-strings-ecpoint2tob" class="sec-ref"><span class="secno">3.1.3</span> <span class="sec-title">Encoding ECPoint2 values as byte strings (ECPoint2ToB)</span></a> in the case of <code>ECPoint2</code> points.
    </p>
    <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_22"><span>Note</span></div><p class="">
      We don't use <a href="http://grouper.ieee.org/groups/1363/IBC/material/P1363.3-D1-200805.pdf">IEEE P1363.3</a> 
      section 6.1.1 IHF1-SHA with security parameter t (e.g. t=128 or 256) 
      as it is more complex and not supported by TPMv2.
    </p></div>
  </section>

  <section id="ecdaa-algorithm-names">
    <h3 aria-level="2" role="heading" id="h3_ecdaa-algorithm-names"><span class="secno">4.2 </span>ECDAA Algorithm Names</h3>

    We define the following JWS-style algorithm names (see [<cite><a class="bibref" href="#bib-RFC7515">RFC7515</a></cite>]):
    <dl>
      <dt>ED256</dt>
      <dd><code>TPM_ECC_BN_P256</code> curve, using SHA256 as hash algorithm H.</dd>
      <dt>ED256-2</dt>
      <dd><code>ECC_BN_DSD_P256</code> curve, using SHA256 as hash algorithm H.</dd>
      <dt>ED512</dt>
      <dd><code>ECC_BN_ISOP512</code> curve, using SHA512 as hash algorithm H.</dd>
      <dt>ED638</dt>
      <dd><code>TPM_ECC_BN_P638</code> curve, using SHA512 as hash algorithm H.</dd>
    </dl>

  </section>

  <section id="ecdaasignature-object">
    <h3 aria-level="2" role="heading" id="h3_ecdaasignature-object"><span class="secno">4.3 </span>ecdaaSignature object</h3>

    <p>
      The fields c and s both have length N.
      The fields R, S, T, W have equal length (2*N+1 each).  
    </p>
    <p>In the case of BN_P256 curve (with key length N=32 bytes), the fields 
      R, S, T, W have length 2*32+1=65 bytes.  The fields c and s have length N=32 each.</p>
    <p>The ecdaaSignature object is a binary object generated as 
      the concatenation of the binary fields in the order described below (total length of 324 bytes for 256bit curves):
    </p>
    <table class="tlv">
      <thead>
	<tr>
	  <th>Value</th>
	  <th>Length (in Bytes)</th>
	  <th>Description</th>
	</tr>
      </thead>      
      <tbody>
	<tr>
	  <td>UINT8[] ECDAA_Signature_c</td>
	  <td>N</td>
	  <td>The c value, c=H(U | S | W | <a href="#dfn-krd" class="internalDFN">KRD</a> | <a href="#dfn-appid" class="internalDFN">AppID</a>) as returned by AuthnrEcdaaSign encoded 
	    as byte string according to BigNumberToB.
	    <p>Where 
	      </p><ul>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3160">U</span><span class="MJXp-mo" id="MJXp-Span-3161" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3163" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3164" style="vertical-align: 0.5em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-239">U = S^r</script>, with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3166">r</span><span class="MJXp-mo" id="MJXp-Span-3167" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3168">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3169">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3170">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3171">D</span><span class="MJXp-mo" id="MJXp-Span-3172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3173">p</span><span class="MJXp-mo" id="MJXp-Span-3174" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-240">r = RAND(p)</script> computed by the signer.</li>
		<li><a href="#dfn-krd" class="internalDFN">KRD</a> is the the entire to-be-signed object (e.g. TAG_UAFV1_KRD in the case of FIDO UAF).</li>
		<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3176">S</span><span class="MJXp-mo" id="MJXp-Span-3177" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3179" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3180" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-241">S = B^l</script>, with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3182">l</span><span class="MJXp-mo" id="MJXp-Span-3183" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3184">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3187">D</span><span class="MJXp-mo" id="MJXp-Span-3188" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3189">p</span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-242">l = RAND(p)</script> computed by the signer and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3192">B</span><span class="MJXp-mo" id="MJXp-Span-3193" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3195" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3196" style="vertical-align: 0.5em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-243">B = A^y</script> computed in the ECDAA-Join</li>
	      </ul>
	    <p>
	  </p></td>
	</tr>
	<tr>
	  <td>UINT8[] ECDAA_Signature_s</td>
	  <td>N</td>
	  <td>The s value, s=r + c * sk (mod p), as returned by AuthnrEcdaaSign encoded 
	    as byte string according to BigNumberToB.
	    <p>Where
	      </p><ul>
		<li>r = RAND(p), computed by the signer at FIDO registration
		  (see <a href="#ecdaa-sign-split-between-authenticator-and-asm" class="sec-ref"><span class="secno">3.5.2</span> <span class="sec-title">ECDAA-Sign Split between Authenticator and ASM</span></a>)</li>
		<li>p is the group order of G1</li>
		<li>sk: is the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>'s attestation secret key, see above</li>
	      </ul>
	    <p></p>
	  </td>
	</tr>

	<tr>
	  <td>UINT8[] ECDAA_Signature_R</td>
	  <td>2*N+1</td>
	  <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3198">R</span><span class="MJXp-mo" id="MJXp-Span-3199" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3201" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3202" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-244">R = A^l</script>; computed by the <a href="#dfn-asm" class="internalDFN">ASM</a> or the 
	    <a href="#dfn-authenticator" class="internalDFN">authenticator</a> at FIDO registration; encoded 
	    as byte string according to ECPointToB.  Where
	    <ul>
	      <li>
		l = RAND(p), i.e. random number 0≤l≤p. 
		Computed by the <a href="#dfn-asm" class="internalDFN">ASM</a> or the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> at FIDO registration.
	      </li>
  	      <li>
		And where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3204">R</span><span class="MJXp-mo" id="MJXp-Span-3205" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3207" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3208" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-245">R = A^l</script> denotes the scalar 
		multiplication (of scalar l) of a curve point A.
	      </li>
	      <li>Where A has been provided by the ECDAA-Issuer as part of ECDAA-Join: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">A</span><span class="MJXp-mo" id="MJXp-Span-3211" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3213" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-3215"><span class="MJXp-msubsup" id="MJXp-Span-3216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3217" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3218" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3214">1</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-246">A = P_1^{l_J}</script>, 
		see <a href="#ecdaa-join-algorithm" class="sec-ref"><span class="secno">3.4.1</span> <span class="sec-title">ECDAA-Join Algorithm</span></a>.
	      </li>
	      <li>Where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3219"><span class="MJXp-msubsup" id="MJXp-Span-3220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3221" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3222" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-247">P_1</script> and p are system values, injected into the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3223"><span class="MJXp-msubsup" id="MJXp-Span-3224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3225" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3226" style="vertical-align: -0.4em;">J</span></span></span></span><script type="math/tex" id="MathJax-Element-248">l_J</script> 
		is a random number computed by the ECDAA-Issuer on Join.</li>
	    </ul>
          </td>
	</tr>
	<tr>
	  <td>UINT8[] ECDAA_Signature_S</td>
	  <td>2*N+1</td>
	  <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3228">S</span><span class="MJXp-mo" id="MJXp-Span-3229" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3231" style="margin-right: 0.05em;">B</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3232" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-249">S = B^l</script>; computed by the <a href="#dfn-asm" class="internalDFN">ASM</a> or the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> at 
	    FIDO registration encoded as byte string according to ECPointToB.
	    <p>Where B has been provided by the ECDAA-Issuer on Join: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3234">B</span><span class="MJXp-mo" id="MJXp-Span-3235" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3237" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3238" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3239">y</span></span></span></span></span><script type="math/tex" id="MathJax-Element-250">B = A^{y}</script>, 
	      see <a href="#ecdaa-join-algorithm" class="sec-ref"><span class="secno">3.4.1</span> <span class="sec-title">ECDAA-Join Algorithm</span></a>.</p>
	  </td>
	</tr>
	<tr>
	  <td>UINT8[] ECDAA_Signature_T</td>
	  <td>2*N+1</td>
	  <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3241">T</span><span class="MJXp-mo" id="MJXp-Span-3242" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3244" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3245" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-251">T = C^l</script>; computed by the <a href="#dfn-asm" class="internalDFN">ASM</a> or the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> 
	    at FIDO registration encoded as byte string according to ECPointToB.
	    Where 
	    <ul>
	      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3247">C</span><span class="MJXp-mo" id="MJXp-Span-3248" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3250" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3251" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3252">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-3253" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-3254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3255" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3256" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3257">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3258">y</span><span class="MJXp-msubsup" id="MJXp-Span-3259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3260" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3261" style="vertical-align: -0.4em;">J</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-252">C = A^{x} \cdot Q^{x y l_J}</script>, provided by the ECDAA-Issuer on Join</li>
	      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3262"><span class="MJXp-msubsup" id="MJXp-Span-3263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3264" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3265" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mo" id="MJXp-Span-3266" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3267">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3269">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3270">D</span><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272">p</span><span class="MJXp-mo" id="MJXp-Span-3273" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-253">l_J = RAND(p)</script> computed by the ECDAA-Issuer at Join 
		(see <a href="#ecdaa-join-algorithm" class="sec-ref"><span class="secno">3.4.1</span> <span class="sec-title">ECDAA-Join Algorithm</span></a>)</li>
	      <li>x and y are components of the ECDAA-Issuer private key, iskk=(x,y).</li>
	      <li>Q is the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> public key</li>
	    </ul>
	  </td>
	</tr>
	<tr>
	  <td>UINT8[] ECDAA_Signature_W</td>
	  <td>2*N+1</td>
	  <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3275">W</span><span class="MJXp-mo" id="MJXp-Span-3276" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3278" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3279" style="vertical-align: 0.5em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-254">W = D^l</script>; computed by the <a href="#dfn-asm" class="internalDFN">ASM</a> or the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> at 
	    FIDO registration encoded as byte string according to ECPointToB.
	    <p>Where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3281">D</span><span class="MJXp-mo" id="MJXp-Span-3282" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3284" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3285" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-3286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3287" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3288" style="vertical-align: -0.4em;">J</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3289">y</span></span></span></span></span><script type="math/tex" id="MathJax-Element-255">D = Q^{l_J y}</script> is computed by the ECDAA-Issuer at Join 
	      (see <a href="#ecdaa-join-algorithm" class="sec-ref"><span class="secno">3.4.1</span> <span class="sec-title">ECDAA-Join Algorithm</span></a>).</p>
	  </td>
	</tr>
      </tbody>
    </table>
  </section>
</section>

<section class="informative" id="considerations">
  <!--OddPage--><h2 aria-level="1" role="heading" id="h2_considerations"><span class="secno">5. </span>Considerations</h2><p><em>This section is non-normative.</em></p>
  A detailed security analysis of this algorithm can be found in [<cite><a class="bibref" href="#bib-FIDO-DAA-Security-Proof">FIDO-DAA-Security-Proof</a></cite>].

  <section id="algorithms-and-key-sizes">
    <h3 aria-level="2" role="heading" id="h3_algorithms-and-key-sizes"><span class="secno">5.1 </span>Algorithms and Key Sizes</h3>
    <p>The proposed algorithms and key sizes are chosen such that compatibility to TPMv2 is possible.</p>
  </section>

  <section id="indicating-the-authenticator-model">
    <h3 aria-level="2" role="heading" id="h3_indicating-the-authenticator-model"><span class="secno">5.2 </span>Indicating the Authenticator Model</h3>
    <p>
      Some authenticators (e.g. TPMv2) do not have the ability to 
      include their model (i.e. vendor ID and model name) in attested messages (i.e. the to-be-signed part
      of the registration assertion).  The TPM's endorsement key certificate typically 
      contains that information directly or at least it allows the model to be derived 
      from the endorsement key certificate.
    </p>
    <p>
      In FIDO, the relying party expects the ability to cryptographically verify the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>
      model.
    </p><p>
      We require the ECDAA-Issuers public key (ipk=(X,Y,c,sx,sy)) 
      to be dedicated to one single <a href="#dfn-authenticator" class="internalDFN">authenticator</a> model (e.g. as identified by AAID or AAGUID).
    </p>
  </section>

  <section id="revocation">
    <h3 aria-level="2" role="heading" id="h3_revocation"><span class="secno">5.3 </span>Revocation</h3>
    <p>
      If the private ECDAA attestation key <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3291">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3292">k</span></span></span><script type="math/tex" id="MathJax-Element-256">sk</script> of an 
      <a href="#dfn-authenticator" class="internalDFN">authenticator</a> has been leaked, it can be revoked by adding
      its value to a RogueList.  
    </p>
    <p>
      The ECDAA-Verifier (i.e. FIDO Server) check for such revocations.  
      See section <a href="#ecdaa-verify-operation" class="sec-ref"><span class="secno">3.6</span> <span class="sec-title">ECDAA-Verify Operation</span></a>.
    </p>
    <p>
      The ECDAA-Issuer is expected to check revocation by other means:
      </p><ol>
	<li>if ECDAA-Join is done in-factory, it is assumed that produced devices are known to be 
	  uncompomised (at time of production).</li>
	<li>if a remote ECDAA-Join is performed, the (remote) ECDAA-Issuer already must use a 
	  different method to remotely authenticate the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> (e.g. using some endorsement key).
	  We expect the ECDAA-Issuer to perform a revocation check based on that information.
	  This is even more flexible as it does not require access to the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>
	  ECDAA private key <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3294">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3295">k</span></span></span><script type="math/tex" id="MathJax-Element-257">sk</script>.
	</li>
      </ol>
    <p></p>
  </section>

  <section id="pairing-algorithm">
    <h3 aria-level="2" role="heading" id="h3_pairing-algorithm"><span class="secno">5.4 </span>Pairing Algorithm</h3>
    <p>
      The pairing algorithm <code>e</code> needs to be used by the <a href="#dfn-asm" class="internalDFN">ASM</a> as part of the Join process and by the
      verifier (i.e. FIDO relying party) as part of the verification (i.e. FIDO registration) process.
    </p>
    <p>
      The result of such a pairing operation is only compared to the result of another 
      pairing operation computed by the same entity.
      As a consequence, it doesn't matter whether the <a href="#dfn-asm" class="internalDFN">ASM</a> and the verifier use the exact same pairings or not
      (as long as they both use valid pairings).
    </p>
    
  </section>

  <section id="performance">
    <h3 aria-level="2" role="heading" id="h3_performance"><span class="secno">5.5 </span>Performance</h3>
    <p>
      For performance reasons the calculation of Sig2=(<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3297">R</span><span class="MJXp-mo" id="MJXp-Span-3298" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3299">S</span><span class="MJXp-mo" id="MJXp-Span-3300" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3301">T</span><span class="MJXp-mo" id="MJXp-Span-3302" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3303">W</span></span></span><script type="math/tex" id="MathJax-Element-258">R, S, T, W</script>) may be performed by the <a href="#dfn-asm" class="internalDFN">ASM</a> running 
      on the FIDO user device (as opposed to inside the <a href="#dfn-authenticator" class="internalDFN">authenticator</a>).  
      See section <a href="#ecdaa-sign-split-between-authenticator-and-asm" class="sec-ref"><span class="secno">3.5.2</span> <span class="sec-title">ECDAA-Sign Split between Authenticator and ASM</span></a>.
    </p>
    <p>
      The cryptographic computations to be performed inside the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> are limited to G1.
      The ECDAA-Issuer has to perform two G2 point multiplications for computing the public key.
      The Verifier (i.e. FIDO relying party) has to perform G1 operations and two pairing operations.
    </p>
    
  </section>

  <section id="binary-concatentation">
    <h3 aria-level="2" role="heading" id="h3_binary-concatentation"><span class="secno">5.6 </span>Binary Concatentation</h3>
    <p>
      We use a simple byte-wise concatenation function for the different parameters, i.e.
      H(a,b) = H(a | b).  
    </p>
    <p>This approach is as secure as the underlying hash algorithm since
      the <a href="#dfn-authenticator" class="internalDFN">authenticator</a> controls the length of the (fixed-length) values (e.g. U, S, W).  
      The <a href="#dfn-appid" class="internalDFN">AppID</a> is provided externally and has unverified structure and length.  However, it is only
      followed by a fixed length entry - the (system defined) hash of <a href="#dfn-krd" class="internalDFN">KRD</a>.  As a consequence, no parts 
      of the <a href="#dfn-appid" class="internalDFN">AppID</a> would ever be confused with the fixed length value.      
    </p>
  </section>

  <section id="iana-considerations">
    <h3 aria-level="2" role="heading" id="h3_iana-considerations"><span class="secno">5.7 </span>IANA Considerations</h3>    
    This specification registers the algorithm names "ED256", "ED512", and "ED638" defined in section 
    <a href="#fido-ecdaa-object-formats-and-algorithm-details" class="sec-ref"><span class="secno">4.</span> <span class="sec-title">FIDO ECDAA Object Formats and Algorithm Details</span></a> 
     with the IANA JSON Web Algorithms registry as defined in section 
    "Cryptographic Algorithms for Digital Signatures and MACs" in [<cite><a class="bibref" href="#bib-RFC7518">RFC7518</a></cite>]. 

    <p>
      </p><table class="tlv">
	<tbody>
	  <tr>
	    <td>Algorithm Name</td>
	    <td>"ED256"</td>
	  </tr>
	  <tr>
	    <td>Algorithm Description</td>
	    <td>FIDO ECDAA algorithm based on TPM_ECC_BN_P256 [<cite><a class="bibref" href="#bib-TPMv2-Part4">TPMv2-Part4</a></cite>] curve using SHA256 hash algorithm.</td>
	  </tr>
	  <tr>
	    <td>Algorithm Usage Location(s)</td>
	    <td>"alg", i.e. used with JWS.</td>
	  </tr>
	  <tr>
	    <td>JOSE Implementation Requirements</td>
	    <td>Optional</td>
	  </tr>
	  <tr>
	    <td>Change Controller</td>
	    <td><abbr title="FIDO Alliance">FIDO Alliance</abbr>, <a href="https://fidoalliance.org/contact/">Contact Us</a></td>
	  </tr>
	  <tr>
	    <td>Specification Documents</td>
	    <td>Sections <a href="#fido-ecdaa-attestation" class="sec-ref"><span class="secno">3.</span> <span class="sec-title">FIDO ECDAA Attestation</span></a>
		and <a href="#fido-ecdaa-object-formats-and-algorithm-details" class="sec-ref"><span class="secno">4.</span> <span class="sec-title">FIDO ECDAA Object Formats and Algorithm Details</span></a> of [<cite><a class="bibref" href="#bib-FIDOEcdaaAlgorithm">FIDOEcdaaAlgorithm</a></cite>].</td>
	  </tr>
	  <tr>
	    <td>Algorithm Analysis Document(s)</td>
	    <td>[<cite><a class="bibref" href="#bib-FIDO-DAA-Security-Proof">FIDO-DAA-Security-Proof</a></cite>]</td>
	  </tr>
	</tbody>
      </table>	
    <p></p>

    <p>
      </p><table class="tlv">
	<tbody>
	  <tr>
	    <td>Algorithm Name</td>
	    <td>"ED512"</td>
	  </tr>
	  <tr>
	    <td>Algorithm Description</td>
	    <td>ECDAA algorithm based on ECC_BN_ISOP512 [<cite><a class="bibref" href="#bib-ISO15946-5">ISO15946-5</a></cite>] curve using SHA512 algorithm.</td>
	  </tr>
	  <tr>
	    <td>Algorithm Usage Location(s)</td>
	    <td>"alg", i.e. used with JWS.</td>
	  </tr>
	  <tr>
	    <td>JOSE Implementation Requirements</td>
	    <td>Optional</td>
	  </tr>
	  <tr>
	    <td>Change Controller</td>
	    <td><abbr title="FIDO Alliance">FIDO Alliance</abbr>, <a href="https://fidoalliance.org/contact/">Contact Us</a></td>
	  </tr>
	  <tr>
	    <td>Specification Documents</td>
	    <td>Sections <a href="#fido-ecdaa-attestation" class="sec-ref"><span class="secno">3.</span> <span class="sec-title">FIDO ECDAA Attestation</span></a>
		and <a href="#fido-ecdaa-object-formats-and-algorithm-details" class="sec-ref"><span class="secno">4.</span> <span class="sec-title">FIDO ECDAA Object Formats and Algorithm Details</span></a> of [<cite><a class="bibref" href="#bib-FIDOEcdaaAlgorithm">FIDOEcdaaAlgorithm</a></cite>].</td>
	  </tr>
	  <tr>
	    <td>Algorithm Analysis Document(s)</td>
	    <td>[<cite><a class="bibref" href="#bib-FIDO-DAA-Security-Proof">FIDO-DAA-Security-Proof</a></cite>]</td>
	  </tr>
	</tbody>
      </table>	
    <p></p>

    <p>
      </p><table class="tlv">
	<tbody>
	  <tr>
	    <td>Algorithm Name</td>
	    <td>"ED638"</td>
	  </tr>
	  <tr>
	    <td>Algorithm Description</td>
	    <td>ECDAA algorithm based on TPM_ECC_BN_P638 [<cite><a class="bibref" href="#bib-TPMv2-Part4">TPMv2-Part4</a></cite>] curve using SHA512 algorithm.</td>
	  </tr>
	  <tr>
	    <td>Algorithm Usage Location(s)</td>
	    <td>"alg", i.e. used with JWS.</td>
	  </tr>
	  <tr>
	    <td>JOSE Implementation Requirements</td>
	    <td>Optional</td>
	  </tr>
	  <tr>
	    <td>Change Controller</td>
	    <td><abbr title="FIDO Alliance">FIDO Alliance</abbr>, <a href="https://fidoalliance.org/contact/">Contact Us</a></td>
	  </tr>
	  <tr>
	    <td>Specification Documents</td>
	    <td>Sections <a href="#fido-ecdaa-attestation" class="sec-ref"><span class="secno">3.</span> <span class="sec-title">FIDO ECDAA Attestation</span></a>
		and <a href="#fido-ecdaa-object-formats-and-algorithm-details" class="sec-ref"><span class="secno">4.</span> <span class="sec-title">FIDO ECDAA Object Formats and Algorithm Details</span></a> of [<cite><a class="bibref" href="#bib-FIDOEcdaaAlgorithm">FIDOEcdaaAlgorithm</a></cite>].</td>
	  </tr>
	  <tr>
	    <td>Algorithm Analysis Document(s)</td>
	    <td>[<cite><a class="bibref" href="#bib-FIDO-DAA-Security-Proof">FIDO-DAA-Security-Proof</a></cite>]</td>
	  </tr>
	</tbody>
      </table>	
    <p></p>

  </section>
</section>

<section id="acknowledgements">
  <!--OddPage--><h2 aria-level="1" role="heading" id="h2_acknowledgements"><span class="secno">6. </span>Acknowledgements</h2>
  We thank Jan Camenisch, Manu Drijvers and Anja Lehmann from IBM Research, 
  Zürich for their review of, and contributions to, this ECDAA algorithm. 
</section>


<section id="references" class="appendix" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><!--OddPage--><h2 aria-level="1" role="heading" id="h2_references"><span class="secno">A. </span>References</h2><section id="normative-references" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h3 aria-level="2" role="heading" id="h3_normative-references"><span class="secno">A.1 </span>Normative references</h3><dl class="bibliography" about=""><dt id="bib-ECDSA-ANSI">[ECDSA-ANSI]</dt><dd rel="dcterms:requires"><a href="http://webstore.ansi.org/RecordDetail.aspx?sku=ANSI+X9.62%3A2005"><cite>Public Key Cryptography for the Financial Services Industry: The Elliptic Curve Digital Signature Algorithm (ECDSA), ANSI X9.62-2005</cite></a>. American National Standards Institute, November 2005, URL: <a href="http://webstore.ansi.org/RecordDetail.aspx?sku=ANSI+X9.62%3A2005">http://webstore.ansi.org/RecordDetail.aspx?sku=ANSI+X9.62%3A2005</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd rel="dcterms:requires">S. Bradner. <a href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
</dd><dt id="bib-RFC3447">[RFC3447]</dt><dd rel="dcterms:requires">J. Jonsson; B. Kaliski. <a href="https://tools.ietf.org/html/rfc3447"><cite>Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</cite></a>. February 2003. Informational. URL: <a href="https://tools.ietf.org/html/rfc3447">https://tools.ietf.org/html/rfc3447</a>
</dd><dt id="bib-TPMv2-Part4">[TPMv2-Part4]</dt><dd rel="dcterms:requires">Trusted Computing Group, <a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C6CABBC-1A4B-B294-D0DA8CE1B452CAB4/TPM%20Rev%202.0%20Part%204%20-%20Supporting%20Routines%2001.16-code.pdf"><cite>Trusted Platform Module Library, Part 4: Supporting Routines</cite></a>, URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C6CABBC-1A4B-B294-D0DA8CE1B452CAB4/TPM%20Rev%202.0%20Part%204%20-%20Supporting%20Routines%2001.16-code.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/8C6CABBC-1A4B-B294-D0DA8CE1B452CAB4/TPM%20Rev%202.0%20Part%204%20-%20Supporting%20Routines%2001.16-code.pdf</a>
</dd></dl></section><section id="informative-references" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h3 aria-level="2" role="heading" id="h3_informative-references"><span class="secno">A.2 </span>Informative references</h3><dl class="bibliography" about=""><dt id="bib-ANZ-2013">[ANZ-2013]</dt><dd rel="dcterms:references">Tolga Acar, Lan Nguyen and Greg Zaverucha, <a href="http://eprint.iacr.org/2013/667.pdf"><cite>A TPM Diffie-Hellman Oracle</cite></a>, October 18, 2013., Microsoft Research, Redmond, WA. URL: <a href="http://eprint.iacr.org/2013/667.pdf">http://eprint.iacr.org/2013/667.pdf</a>
</dd><dt id="bib-Arthur-Challener-2015">[Arthur-Challener-2015]</dt><dd rel="dcterms:references">Will Arthur and David Challener with Kenneth Goldman, <a href="http://www.apress.com/9781430265832"><cite>A Practical Guide to TPM 2.0: Using the Trusted Platform Module in the New Age of Security</cite></a>, 2014, URL: <a href="http://www.apress.com/9781430265832">http://www.apress.com/9781430265832</a>
</dd><dt id="bib-BFGSW-2011">[BFGSW-2011]</dt><dd rel="dcterms:references">D. Bernhard, G. Fuchsbauer, E. Ghadafi, N. P. Smart and B. Warinschi, <a href="http://eprint.iacr.org/2011/658.pdf"><cite>Anonymous attestation with user-controlled linkability</cite></a>, 2011, URL: <a href="http://eprint.iacr.org/2011/658.pdf">http://eprint.iacr.org/2011/658.pdf</a>
</dd><dt id="bib-BarNae-2006">[BarNae-2006]</dt><dd rel="dcterms:references">Paulo S. L. M. Barreto and Michael Naehrig, <a href="http://research.microsoft.com/pubs/118425/pfcpo.pdf"><cite>Pairing-Friendly Elliptic Curves of Prime Order</cite></a>, 2006, URL: <a href="http://research.microsoft.com/pubs/118425/pfcpo.pdf">http://research.microsoft.com/pubs/118425/pfcpo.pdf</a>
</dd><dt id="bib-BriCamChe2004-DAA">[BriCamChe2004-DAA]</dt><dd rel="dcterms:references">Ernie Brickell, Intel Corporation; Jan Camenisch, IBM Research; Liqun Chen, HP Laboratories, <a href="http://eprint.iacr.org/2004/205.pdf"><cite>Direct Anonymous Attestation</cite></a>, 2004, URL: <a href="http://eprint.iacr.org/2004/205.pdf">http://eprint.iacr.org/2004/205.pdf</a>
</dd><dt id="bib-CheLi2013-ECDAA">[CheLi2013-ECDAA]</dt><dd rel="dcterms:references">Liqun Chen, HP Laboratories and Jiangtao Li, Intel Corporation, <a href="http://dx.doi.org/10.1145/2508859.2516729"><cite>Flexible and Scalable Digital Signatures in TPM 2.0</cite></a>, 2013. URL: <a href="http://dx.doi.org/10.1145/2508859.2516729">http://dx.doi.org/10.1145/2508859.2516729</a>
</dd><dt id="bib-DevScoDah2007">[DevScoDah2007]</dt><dd rel="dcterms:references">Augusto Jun Devegili, Michael Scott, and Ricardo Dahab <a href="https://eprint.iacr.org/2007/390.pdf"><cite>Implementing Cryptographic Pairings over Barreto-Naehrig Curves</cite></a>. 2007, URL: <a href="https://eprint.iacr.org/2007/390.pdf">https://eprint.iacr.org/2007/390.pdf</a>
</dd><dt id="bib-FIDO-DAA-Security-Proof">[FIDO-DAA-Security-Proof]</dt><dd rel="dcterms:references">Jan Camenisch; Manu Drijvers; Anja Lehmann. <a href="https://eprint.iacr.org/2015/1246"><cite>Universally Composable Direct Anonymous Attestation</cite></a>. 2015. URL: <a href="https://eprint.iacr.org/2015/1246">https://eprint.iacr.org/2015/1246</a>
</dd><dt id="bib-FIDOEcdaaAlgorithm">[FIDOEcdaaAlgorithm]</dt><dd rel="dcterms:references">R. Lindemann, A. Edgington, R. Urian, <cite>FIDO ECDAA Algorithm</cite>. FIDO Alliance Proposed Standard. URLs: <br>HTML: <a href="./fido-ecdaa-algorithm.-v1.1-rd-20160709.html">fido-ecdaa-algorithm-ps-20141208.html.-v1.1-rd-20160709</a><br>PDF: <a href="./fido-ecdaa-algorithm.-v1.1-rd-20160709.pdf">fido-ecdaa-algorithm-ps-20141208.pdf.-v1.1-rd-20160709</a>
</dd><dt id="bib-FIDOGlossary">[FIDOGlossary]</dt><dd rel="dcterms:references">R. Lindemann, D. Baghdasaryan, B. Hill, J. Hodges, <cite>FIDO Technical Glossary</cite>. FIDO Alliance Proposed Standard. URLs: <br>HTML: <a href="./fido-glossary-v1.1-rd-20160709.html">fido-glossary-v1.1-rd-20160709.html</a> <br>PDF: <a href="./fido-glossary-v1.1-rd-20160709.pdf">fido-glossary-v1.1-rd-20160709.pdf</a>
</dd><dt id="bib-ISO15946-5">[ISO15946-5]</dt><dd rel="dcterms:references">ISO/IEC 15946-5, <a href="https://webstore.iec.ch/publication/10468"><cite>Information Technology - Security Techniques - Cryptographic techniques based on elliptic curves - Part 5: Elliptic curve generation</cite></a>, URL: <a href="https://webstore.iec.ch/publication/10468">https://webstore.iec.ch/publication/10468</a>
</dd><dt id="bib-RFC7515">[RFC7515]</dt><dd rel="dcterms:references">M. Jones, J. Bradley, N. Sakimura, <a href="http://www.ietf.org/rfc/rfc7515.txt"><cite>JSON Web Signature (JWS) (RFC7515)</cite></a>, IETF, May 2015, URL: <a href="http://www.ietf.org/rfc/rfc7515.txt">http://www.ietf.org/rfc/rfc7515.txt</a>
</dd><dt id="bib-RFC7518">[RFC7518]</dt><dd rel="dcterms:references">M. Jones. <a href="https://tools.ietf.org/html/rfc7518"><cite>JSON Web Algorithms (JWA)</cite></a>. May 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7518">https://tools.ietf.org/html/rfc7518</a>
</dd><dt id="bib-TPMv1-2-Part1">[TPMv1-2-Part1]</dt><dd rel="dcterms:references">Trusted Computing Group, <a href="http://www.trustedcomputinggroup.org/files/static_page_files/72C26AB5-1A4B-B294-D002BC0B8C062FF6/TPM%20Main-Part%201%20Design%20Principles_v1.2_rev116_01032011.pdf"><cite>TPM 1.2 Part 1: Design Principles</cite></a>, URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/72C26AB5-1A4B-B294-D002BC0B8C062FF6/TPM%20Main-Part%201%20Design%20Principles_v1.2_rev116_01032011.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/72C26AB5-1A4B-B294-D002BC0B8C062FF6/TPM%20Main-Part%201%20Design%20Principles_v1.2_rev116_01032011.pdf</a>
</dd><dt id="bib-TPMv2-Part1">[TPMv2-Part1]</dt><dd rel="dcterms:references">Trusted Computing Group, <a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C56AE3E-1A4B-B294-D0F43097156A55D8/TPM%20Rev%202.0%20Part%201%20-%20Architecture%2001.16.pdf"><cite>Trusted Platform Module Library, Part 1: Architecture</cite></a>, URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C56AE3E-1A4B-B294-D0F43097156A55D8/TPM%20Rev%202.0%20Part%201%20-%20Architecture%2001.16.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/8C56AE3E-1A4B-B294-D0F43097156A55D8/TPM%20Rev%202.0%20Part%201%20-%20Architecture%2001.16.pdf</a>
</dd><dt id="bib-TPMv2-Part2">[TPMv2-Part2]</dt><dd rel="dcterms:references">Trusted Computing Group, <a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf"><cite>Trusted Platform Module Library, Part 2: Structures</cite></a>, URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf</a>
</dd><dt id="bib-XYZF-2014">[XYZF-2014]</dt><dd rel="dcterms:references">Li Xi, Kang Yang, Zhenfeng Zhang, and Dengguo Feng, <cite>DAA-Related APIs in TPM 2.0 Revisited</cite>, 2014, in T. Holz and S. Ioannidis (Eds.): TRUST 2014, LNCS 8564, pp. 1–18, 2014.
</dd></dl></section></section><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, monospace;"></div></div></body></html>
